"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[877],{7877:function(o,a,e){e.r(a),e.d(a,{default:function(){return lo}});var r=e(6768),t=e(5130),s=e(4232);const l={class:"trasladar-cantidades"},i={class:"top-buttons"},n={class:"form-section"},d={class:"filters"},c={class:"filter-group"},u={class:"filter-group"},g=["value"],p={class:"filter-group"},h={class:"filter-actions"},b={key:0,class:"table-container"},v={class:"form-section"},k={class:"filters"},C={class:"filter-group"},f={class:"filter-group"},m=["value"],L={class:"filter-group"},T={class:"bodegas-grid"},_={class:"filter-group"},P=["value"],E={class:"filter-group"},y=["value"],I={class:"filter-group"},F={class:"filter-actions"},D={key:0,class:"form-section"},B={class:"table-container"},S=["onClick"],$={class:"form-actions"},w={class:"form-section"},N={class:"filters"},z={class:"filter-group"},A={class:"filter-group"},x=["value"],X={class:"filter-group"},U={class:"filter-group"},O={class:"fechas-grid"},V={class:"filter-group"},K={class:"filter-group"},J={class:"filter-group"},W=["value"],R={class:"filter-group"},q=["value"],Q={class:"filter-actions"},j={key:0,class:"card-container"},M={class:"form-actions"},G=["onClick"],H={key:1,class:"card-container"},Y={class:"form-actions"};function Z(o,a,e,Z,oo,ao){const eo=(0,r.g2)("font-awesome-icon");return(0,r.uX)(),(0,r.CE)("div",l,[a[77]||(a[77]=(0,r.Lk)("h1",null,"Trasladar Cantidades entre Bodegas",-1)),(0,r.Lk)("div",i,[(0,r.Lk)("button",{onClick:a[0]||(a[0]=(...o)=>ao.limpiarPagina&&ao.limpiarPagina(...o)),class:"btn btn-warning"},"Limpiar Página")]),(0,r.Lk)("section",n,[a[42]||(a[42]=(0,r.Lk)("h2",null,"Consulta de Inventario",-1)),a[43]||(a[43]=(0,r.Lk)("h3",null,"Buscar por:",-1)),(0,r.Lk)("div",d,[(0,r.Lk)("div",c,[a[35]||(a[35]=(0,r.Lk)("label",{for:"nombreConsulta"},"Nombre:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[1]||(a[1]=o=>oo.nombreConsulta=o),id:"nombreConsulta",placeholder:"Ingrese nombre del producto",onInput:a[2]||(a[2]=(...o)=>ao.sincronizarPorNombre&&ao.sincronizarPorNombre(...o))},null,544),[[t.Jo,oo.nombreConsulta]])]),(0,r.Lk)("div",u,[a[37]||(a[37]=(0,r.Lk)("label",{for:"productoConsulta"},"Selección del producto:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":a[3]||(a[3]=o=>oo.productoConsulta=o),id:"productoConsulta",onChange:a[4]||(a[4]=(...o)=>ao.sincronizarSelectorConCodigo&&ao.sincronizarSelectorConCodigo(...o))},[a[36]||(a[36]=(0,r.Lk)("option",{value:"",disabled:""},"Seleccione un producto",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.productos,(o=>((0,r.uX)(),(0,r.CE)("option",{key:o.id,value:o.codigo},(0,s.v_)(o.codigo)+" - "+(0,s.v_)(o.nombre),9,g)))),128))],544),[[t.u1,oo.productoConsulta]])]),(0,r.Lk)("div",p,[a[38]||(a[38]=(0,r.Lk)("label",{for:"codigoConsulta"},"Código del producto:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[5]||(a[5]=o=>oo.codigoConsulta=o),id:"codigoConsulta",placeholder:"Ingrese código del producto",onInput:a[6]||(a[6]=(...o)=>ao.sincronizarCodigoConSelector&&ao.sincronizarCodigoConSelector(...o))},null,544),[[t.Jo,oo.codigoConsulta]])]),(0,r.Lk)("div",h,[(0,r.Lk)("button",{onClick:a[7]||(a[7]=(...o)=>ao.consultarInventario&&ao.consultarInventario(...o)),class:"btn"},"Consultar Inventario")])]),oo.inventario.length?((0,r.uX)(),(0,r.CE)("div",b,[a[41]||(a[41]=(0,r.Lk)("h3",null,"Inventario del Producto",-1)),(0,r.Lk)("table",null,[(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[a[39]||(a[39]=(0,r.Lk)("th",null,"Código",-1)),a[40]||(a[40]=(0,r.Lk)("th",null,"Nombre",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.bodegas,(o=>((0,r.uX)(),(0,r.CE)("th",{key:o.id},(0,s.v_)(o.nombre),1)))),128))])]),(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",null,(0,s.v_)(oo.inventarioProducto.codigo),1),(0,r.Lk)("td",null,(0,s.v_)(oo.inventarioProducto.nombre),1),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.bodegas,(o=>((0,r.uX)(),(0,r.CE)("td",{key:o.id},(0,s.v_)(ao.obtenerCantidadEnBodega(o.nombre)),1)))),128))])])])])):(0,r.Q3)("",!0)]),(0,r.Lk)("section",v,[a[53]||(a[53]=(0,r.Lk)("h2",null,"Agregar Productos al Traslado",-1)),a[54]||(a[54]=(0,r.Lk)("h3",null,"Buscar por:",-1)),(0,r.Lk)("div",k,[(0,r.Lk)("div",C,[a[44]||(a[44]=(0,r.Lk)("label",{for:"nombreTraslado"},"Nombre:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[8]||(a[8]=o=>oo.nombreTraslado=o),id:"nombreTraslado",placeholder:"Ingrese nombre del producto",onInput:a[9]||(a[9]=(...o)=>ao.sincronizarPorNombreTraslado&&ao.sincronizarPorNombreTraslado(...o))},null,544),[[t.Jo,oo.nombreTraslado]])]),(0,r.Lk)("div",f,[a[46]||(a[46]=(0,r.Lk)("label",{for:"codigo"},"Selección del Producto:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":a[10]||(a[10]=o=>oo.nuevoTraslado.codigo=o),id:"codigo",onChange:a[11]||(a[11]=(...o)=>ao.sincronizarSelectorConCodigoTraslado&&ao.sincronizarSelectorConCodigoTraslado(...o))},[a[45]||(a[45]=(0,r.Lk)("option",{value:"",disabled:""},"Seleccione un producto",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.productos,(o=>((0,r.uX)(),(0,r.CE)("option",{key:o.id,value:o.codigo},(0,s.v_)(o.codigo)+" - "+(0,s.v_)(o.nombre),9,m)))),128))],544),[[t.u1,oo.nuevoTraslado.codigo]])]),(0,r.Lk)("div",L,[a[47]||(a[47]=(0,r.Lk)("label",{for:"codigoIngresado"},"Código del producto:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[12]||(a[12]=o=>oo.codigoTraslado=o),id:"codigoIngresado",placeholder:"Ingrese código del producto",onInput:a[13]||(a[13]=(...o)=>ao.sincronizarCodigoConSelectorTraslado&&ao.sincronizarCodigoConSelectorTraslado(...o))},null,544),[[t.Jo,oo.codigoTraslado]])]),(0,r.Lk)("div",T,[(0,r.Lk)("div",_,[a[49]||(a[49]=(0,r.Lk)("label",{for:"bodega_origen"},"Bodega Origen:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":a[14]||(a[14]=o=>oo.nuevoTraslado.bodega_origen=o),id:"bodega_origen"},[a[48]||(a[48]=(0,r.Lk)("option",{value:"",disabled:""},"Seleccione una bodega",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.bodegas,(o=>((0,r.uX)(),(0,r.CE)("option",{key:o.id,value:o.nombre},(0,s.v_)(o.nombre),9,P)))),128))],512),[[t.u1,oo.nuevoTraslado.bodega_origen]])]),(0,r.Lk)("div",E,[a[51]||(a[51]=(0,r.Lk)("label",{for:"bodega_destino"},"Bodega Destino:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":a[15]||(a[15]=o=>oo.nuevoTraslado.bodega_destino=o),id:"bodega_destino"},[a[50]||(a[50]=(0,r.Lk)("option",{value:"",disabled:""},"Seleccione una bodega",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.bodegas,(o=>((0,r.uX)(),(0,r.CE)("option",{key:o.id,value:o.nombre},(0,s.v_)(o.nombre),9,y)))),128))],512),[[t.u1,oo.nuevoTraslado.bodega_destino]])]),(0,r.Lk)("div",I,[a[52]||(a[52]=(0,r.Lk)("label",{for:"cantidad"},"Cantidad:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[16]||(a[16]=o=>oo.nuevoTraslado.cantidad=o),id:"cantidad",type:"number",min:"1"},null,512),[[t.Jo,oo.nuevoTraslado.cantidad,void 0,{number:!0}]])])]),(0,r.Lk)("div",F,[(0,r.Lk)("button",{onClick:a[17]||(a[17]=(...o)=>ao.agregarProductoATraslado&&ao.agregarProductoATraslado(...o)),class:"btn"},"Agregar Producto al Traslado")])])]),oo.productosATrasladar.length?((0,r.uX)(),(0,r.CE)("section",D,[a[56]||(a[56]=(0,r.Lk)("h2",null,"Productos en el Traslado",-1)),(0,r.Lk)("div",B,[(0,r.Lk)("table",null,[a[55]||(a[55]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Código"),(0,r.Lk)("th",null,"Nombre"),(0,r.Lk)("th",null,"Bodega Origen"),(0,r.Lk)("th",null,"Bodega Destino"),(0,r.Lk)("th",null,"Cantidad"),(0,r.Lk)("th",null,"Acciones")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.productosATrasladar,((o,a)=>((0,r.uX)(),(0,r.CE)("tr",{key:a},[(0,r.Lk)("td",null,(0,s.v_)(o.codigo),1),(0,r.Lk)("td",null,(0,s.v_)(o.nombre),1),(0,r.Lk)("td",null,(0,s.v_)(o.bodega_origen),1),(0,r.Lk)("td",null,(0,s.v_)(o.bodega_destino),1),(0,r.Lk)("td",null,(0,s.v_)(o.cantidad),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{onClick:o=>ao.eliminarProductoDelTraslado(a),class:"btn btn-danger"},"Eliminar",8,S)])])))),128))])])]),(0,r.Lk)("div",$,[(0,r.Lk)("button",{onClick:a[18]||(a[18]=(...o)=>ao.confirmarTraslado&&ao.confirmarTraslado(...o)),class:"btn"},"Trasladar Productos")])])):(0,r.Q3)("",!0),(0,r.Lk)("section",w,[a[75]||(a[75]=(0,r.Lk)("h2",null,"Consulta de Traslados",-1)),a[76]||(a[76]=(0,r.Lk)("h3",null,"Buscar por:",-1)),(0,r.Lk)("div",N,[(0,r.Lk)("div",z,[a[57]||(a[57]=(0,r.Lk)("label",{for:"nombreConsultaTraslados"},"Nombre:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[19]||(a[19]=o=>oo.nombreConsultaTraslados=o),id:"nombreConsultaTraslados",placeholder:"Ingrese nombre del producto",onInput:a[20]||(a[20]=(...o)=>ao.sincronizarPorNombreTraslados&&ao.sincronizarPorNombreTraslados(...o))},null,544),[[t.Jo,oo.nombreConsultaTraslados]])]),(0,r.Lk)("div",A,[a[59]||(a[59]=(0,r.Lk)("label",{for:"productoConsultaTraslados"},"Selección del Producto:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":a[21]||(a[21]=o=>oo.filtroProducto=o),id:"productoConsultaTraslados",onChange:a[22]||(a[22]=(...o)=>ao.sincronizarSelectorConCodigoTraslados&&ao.sincronizarSelectorConCodigoTraslados(...o))},[a[58]||(a[58]=(0,r.Lk)("option",{value:"",disabled:""},"Seleccione un producto",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.productos,(o=>((0,r.uX)(),(0,r.CE)("option",{key:o.id,value:o.codigo},(0,s.v_)(o.codigo)+" - "+(0,s.v_)(o.nombre),9,x)))),128))],544),[[t.u1,oo.filtroProducto]])]),(0,r.Lk)("div",X,[a[60]||(a[60]=(0,r.Lk)("label",{for:"codigoConsultaTraslados"},"Código del producto:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[23]||(a[23]=o=>oo.codigoConsultaTraslados=o),id:"codigoConsultaTraslados",placeholder:"Ingrese código del producto",onInput:a[24]||(a[24]=(...o)=>ao.sincronizarCodigoConSelectorTraslados&&ao.sincronizarCodigoConSelectorTraslados(...o))},null,544),[[t.Jo,oo.codigoConsultaTraslados]])]),(0,r.Lk)("div",U,[a[61]||(a[61]=(0,r.Lk)("label",{for:"consecutivo"},"Consecutivo:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[25]||(a[25]=o=>oo.filtroConsecutivo=o),id:"consecutivo",placeholder:"Ingrese consecutivo"},null,512),[[t.Jo,oo.filtroConsecutivo]])]),(0,r.Lk)("div",O,[(0,r.Lk)("div",V,[a[62]||(a[62]=(0,r.Lk)("label",{for:"fechaInicio"},"Fecha inicio:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"date",id:"fechaInicio","onUpdate:modelValue":a[26]||(a[26]=o=>oo.fechaInicio=o)},null,512),[[t.Jo,oo.fechaInicio]])]),(0,r.Lk)("div",K,[a[63]||(a[63]=(0,r.Lk)("label",{for:"fechaFin"},"Fecha fin:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"date",id:"fechaFin","onUpdate:modelValue":a[27]||(a[27]=o=>oo.fechaFin=o)},null,512),[[t.Jo,oo.fechaFin]])]),(0,r.Lk)("div",J,[a[65]||(a[65]=(0,r.Lk)("label",{for:"filtroBodegaOrigen"},"Bodega de Origen:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":a[28]||(a[28]=o=>oo.filtroBodegaOrigen=o),id:"filtroBodegaOrigen"},[a[64]||(a[64]=(0,r.Lk)("option",{value:"",disabled:""},"Seleccione una bodega",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.bodegas,(o=>((0,r.uX)(),(0,r.CE)("option",{key:o.id,value:o.nombre},(0,s.v_)(o.nombre),9,W)))),128))],512),[[t.u1,oo.filtroBodegaOrigen]])]),(0,r.Lk)("div",R,[a[67]||(a[67]=(0,r.Lk)("label",{for:"filtroBodegaDestino"},"Bodega de Destino:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":a[29]||(a[29]=o=>oo.filtroBodegaDestino=o),id:"filtroBodegaDestino"},[a[66]||(a[66]=(0,r.Lk)("option",{value:"",disabled:""},"Seleccione una bodega",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.bodegas,(o=>((0,r.uX)(),(0,r.CE)("option",{key:o.id,value:o.nombre},(0,s.v_)(o.nombre),9,q)))),128))],512),[[t.u1,oo.filtroBodegaDestino]])]),(0,r.Lk)("div",Q,[(0,r.Lk)("button",{onClick:a[30]||(a[30]=(...o)=>ao.consultarTraslados&&ao.consultarTraslados(...o)),class:"btn"},"Consultar Traslados")])])]),oo.traslados.length?((0,r.uX)(),(0,r.CE)("section",j,[a[71]||(a[71]=(0,r.Lk)("h3",null,"Resultados de la Consulta",-1)),(0,r.Lk)("div",M,[(0,r.Lk)("button",{onClick:a[31]||(a[31]=(...o)=>ao.imprimirTrasladosPDF&&ao.imprimirTrasladosPDF(...o)),class:"btn btn-export"},[a[68]||(a[68]=(0,r.eW)(" Imprimir Listado ")),(0,r.bF)(eo,{icon:"file-pdf",class:"pdf-icon"})]),(0,r.Lk)("button",{onClick:a[32]||(a[32]=(...o)=>ao.exportarTrasladosExcel&&ao.exportarTrasladosExcel(...o)),class:"btn btn-export"},[a[69]||(a[69]=(0,r.eW)(" Exportar Listado ")),(0,r.bF)(eo,{icon:"file-excel",class:"excel-icon"})])]),(0,r.Lk)("table",null,[a[70]||(a[70]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Consecutivo"),(0,r.Lk)("th",null,"Fecha"),(0,r.Lk)("th",null,"Acción")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.traslados,(o=>((0,r.uX)(),(0,r.CE)("tr",{key:o.consecutivo},[(0,r.Lk)("td",null,(0,s.v_)(o.consecutivo),1),(0,r.Lk)("td",null,(0,s.v_)(o.fecha),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{onClick:a=>ao.verDetalleTraslado(o.consecutivo),class:"btn"},"Detalle",8,G)])])))),128))])])])):(0,r.Q3)("",!0),oo.detalleTraslado.length?((0,r.uX)(),(0,r.CE)("section",H,[(0,r.Lk)("h3",null,"Detalle del Traslado "+(0,s.v_)(oo.trasladoSeleccionado),1),(0,r.Lk)("div",Y,[(0,r.Lk)("button",{onClick:a[33]||(a[33]=(...o)=>ao.imprimirDetalleTrasladoPDF&&ao.imprimirDetalleTrasladoPDF(...o)),class:"btn btn-export"},[a[72]||(a[72]=(0,r.eW)(" Imprimir ")),(0,r.bF)(eo,{icon:"file-pdf",class:"pdf-icon"})]),(0,r.Lk)("button",{onClick:a[34]||(a[34]=(...o)=>ao.exportarDetalleTrasladoExcel&&ao.exportarDetalleTrasladoExcel(...o)),class:"btn btn-export"},[a[73]||(a[73]=(0,r.eW)(" Exportar ")),(0,r.bF)(eo,{icon:"file-excel",class:"excel-icon"})])]),(0,r.Lk)("table",null,[a[74]||(a[74]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Consecutivo"),(0,r.Lk)("th",null,"Fecha"),(0,r.Lk)("th",null,"Producto"),(0,r.Lk)("th",null,"Cantidad"),(0,r.Lk)("th",null,"Bodega Origen"),(0,r.Lk)("th",null,"Bodega Destino")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(oo.detalleTraslado,(o=>((0,r.uX)(),(0,r.CE)("tr",{key:o.id},[(0,r.Lk)("td",null,(0,s.v_)(o.consecutivo),1),(0,r.Lk)("td",null,(0,s.v_)(o.fecha),1),(0,r.Lk)("td",null,(0,s.v_)(o.producto),1),(0,r.Lk)("td",null,(0,s.v_)(o.cantidad),1),(0,r.Lk)("td",null,(0,s.v_)(o.bodega_origen),1),(0,r.Lk)("td",null,(0,s.v_)(o.bodega_destino),1)])))),128))])])])):(0,r.Q3)("",!0)])])}e(4114),e(8111),e(116),e(7588),e(1701),e(7642),e(8004),e(3853),e(5876),e(2475),e(5024),e(1698),e(4603),e(7566),e(8721);var oo=e(7682),ao=e(3230),eo=e(292),ro={name:"TrasladarCantidades",components:{FontAwesomeIcon:eo.gc},data(){return{productoConsulta:"",nombreConsulta:"",codigoConsulta:"",nuevoTraslado:{codigo:"",bodega_origen:"",bodega_destino:"",cantidad:0},nombreTraslado:"",codigoTraslado:"",productos:[],bodegas:[],productosATrasladar:[],inventario:[],inventarioProducto:{codigo:"",nombre:""},filtroConsecutivo:"",filtroProducto:"",nombreConsultaTraslados:"",codigoConsultaTraslados:"",fechaInicio:"",fechaFin:"",filtroBodegaOrigen:"",filtroBodegaDestino:"",traslados:[],detalleTraslado:[],trasladoSeleccionado:""}},methods:{limpiarPagina(){this.productoConsulta="",this.nombreConsulta="",this.codigoConsulta="",this.inventario=[],this.inventarioProducto={codigo:"",nombre:""},this.nuevoTraslado={codigo:"",bodega_origen:"",bodega_destino:"",cantidad:0},this.nombreTraslado="",this.codigoTraslado="",this.productosATrasladar=[],this.nombreConsultaTraslados="",this.codigoConsultaTraslados="",this.filtroConsecutivo="",this.filtroProducto="",this.fechaInicio="",this.fechaFin="",this.filtroBodegaOrigen="",this.filtroBodegaDestino="",this.traslados=[],this.detalleTraslado=[],this.trasladoSeleccionado=""},async cargarProductos(){try{const o=await oo.A.get("/api/productos/completos");this.productos=o.data.sort(((o,a)=>o.codigo.localeCompare(a.codigo)))}catch(o){console.error("Error al cargar productos:",o),403===o.response?.status?(alert("No tienes permiso para acceder a los productos."),this.$router.push("/login")):alert("No se pudieron cargar los productos.")}},async cargarBodegas(){try{const o=await oo.A.get("/inventory/bodegas");this.bodegas=o.data}catch(o){console.error("Error al cargar bodegas:",o),403===o.response?.status?(alert("No tienes permiso para acceder a las bodegas."),this.$router.push("/login")):alert("No se pudieron cargar las bodegas.")}},async consultarInventario(){if(this.productoConsulta)try{const o=await oo.A.get(`/api/inventario/${this.productoConsulta}`);if(o.data.message)return alert(o.data.message),this.inventarioProducto={codigo:"",nombre:""},void(this.inventario=[]);this.inventarioProducto=o.data.producto,this.inventario=o.data.inventario}catch(o){console.error("Error al consultar inventario:",o),403===o.response?.status?(alert("No tienes permiso para consultar el inventario."),this.$router.push("/login")):404===o.response?.status?alert("Producto no encontrado."):alert("Ocurrió un error al consultar el inventario.")}else alert("Seleccione un producto para consultar su inventario")},obtenerCantidadEnBodega(o){const a=this.inventario.find((a=>a.bodega===o));return a?a.cantidad:0},async agregarProductoATraslado(){if(!this.nuevoTraslado.codigo||!this.nuevoTraslado.bodega_origen||!this.nuevoTraslado.bodega_destino||!this.nuevoTraslado.cantidad||this.nuevoTraslado.cantidad<=0)return void alert("Complete todos los campos y asegúrese de que la cantidad sea mayor a 0.");if(this.nuevoTraslado.bodega_origen===this.nuevoTraslado.bodega_destino)return void alert("La bodega origen y destino no pueden ser la misma.");const o=this.productos.find((o=>o.codigo===this.nuevoTraslado.codigo));try{const a=await oo.A.get(`/api/inventario/${this.nuevoTraslado.codigo}`),e=a.data.inventario,r=e.find((o=>o.bodega===this.nuevoTraslado.bodega_origen))?.cantidad||0;if(r<this.nuevoTraslado.cantidad)return void alert(`No hay suficiente inventario en ${this.nuevoTraslado.bodega_origen}. Disponible: ${r}`);this.productosATrasladar.push({...this.nuevoTraslado,nombre:o.nombre}),this.nuevoTraslado={codigo:"",bodega_origen:"",bodega_destino:"",cantidad:0},this.nombreTraslado="",this.codigoTraslado=""}catch(a){console.error("Error al verificar inventario:",a),alert("No se pudo verificar el inventario para el traslado.")}},eliminarProductoDelTraslado(o){this.productosATrasladar.splice(o,1)},async confirmarTraslado(){if(this.productosATrasladar.length)try{for(const a of this.productosATrasladar){const o=await oo.A.get(`/api/inventario/${a.codigo}`),e=o.data.inventario,r=e.find((o=>o.bodega===a.bodega_origen))?.cantidad||0;if(console.debug(`Validando ${a.codigo}: Disponible=${r}, Requerido=${a.cantidad}`),r<a.cantidad)return void alert(`Inventario insuficiente para ${a.codigo} en ${a.bodega_origen}. Disponible: ${r}`)}const o=await oo.A.post("/api/trasladar_varios",{productos:this.productosATrasladar});alert(`Traslado realizado con consecutivo: ${o.data.consecutivo}`),this.limpiarPagina()}catch(o){console.error("Error al confirmar traslado:",o),403===o.response?.status?(alert("No tienes permiso para realizar traslados."),this.$router.push("/login")):o.response?.data?.error?alert(o.response.data.error):alert("Ocurrió un error al realizar el traslado.")}else alert("Debe agregar al menos un producto al traslado.")},async consultarTraslados(){try{const o={consecutivo:this.filtroConsecutivo||void 0,codigo:this.filtroProducto||void 0,fecha_inicio:this.fechaInicio||void 0,fecha_fin:this.fechaFin||void 0,bodega_origen:this.filtroBodegaOrigen||void 0,bodega_destino:this.filtroBodegaDestino||void 0},a=await oo.A.get("/api/traslados-por-bodega",{params:o}),e=[],r=new Set;a.data.forEach((o=>{r.has(o.consecutivo)||(r.add(o.consecutivo),e.push({consecutivo:o.consecutivo,fecha:o.fecha}))})),this.traslados=e,this.detalleTraslado=[]}catch(o){console.error("Error al consultar traslados:",o),403===o.response?.status?(alert("No tienes permiso para consultar traslados."),this.$router.push("/login")):alert("Ocurrió un error al consultar los traslados.")}},async verDetalleTraslado(o){try{this.trasladoSeleccionado=o;const a=await oo.A.get("/api/traslados",{params:{consecutivo:o}});this.detalleTraslado=a.data.map((o=>({id:`${o.consecutivo}-${o.producto}`,consecutivo:o.consecutivo,fecha:o.fecha,producto:o.producto,cantidad:o.cantidad,bodega_origen:o.bodega_origen,bodega_destino:o.bodega_destino})))}catch(a){console.error("Error al obtener detalle del traslado:",a),403===a.response?.status?(alert("No tienes permiso para ver detalles de traslados."),this.$router.push("/login")):alert("No se pudo recuperar el detalle del traslado.")}},async imprimirTrasladosPDF(){try{const o={consecutivo:this.filtroConsecutivo||void 0,codigo:this.filtroProducto||void 0,fecha_inicio:this.fechaInicio||void 0,fecha_fin:this.fechaFin||void 0,bodega_origen:this.filtroBodegaOrigen||void 0,bodega_destino:this.filtroBodegaDestino||void 0},a=await oo.A.get("/api/traslados-pdf",{params:o,responseType:"blob"}),e=window.URL.createObjectURL(new Blob([a.data])),r=document.createElement("a");r.href=e,r.setAttribute("download",`traslados_${this.fechaInicio||"todos"}_al_${this.fechaFin||"todos"}.pdf`),document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(o){console.error("Error al generar el PDF de traslados:",o),403===o.response?.status?(alert("No tienes permiso para generar PDFs."),this.$router.push("/login")):alert("No se pudo generar el PDF de traslados.")}},exportarTrasladosExcel(){if(!this.traslados.length)return void alert("No hay datos para exportar a Excel.");const o=[["Traslados Realizados"],[`Rango de fecha: ${this.fechaInicio||"Todos"} - ${this.fechaFin||"Todos"}`],[`Bodega de Origen: ${this.filtroBodegaOrigen||"Cualquiera"}`],[`Bodega de Destino: ${this.filtroBodegaDestino||"Cualquiera"}`],[],["Consecutivo","Fecha"]];this.traslados.forEach((a=>{o.push([a.consecutivo,a.fecha])}));const a=ao.Wp.aoa_to_sheet(o),e=ao.Wp.book_new();ao.Wp.book_append_sheet(e,a,"Traslados"),ao._h(e,`traslados_${this.fechaInicio||"todos"}_al_${this.fechaFin||"todos"}.xlsx`)},async imprimirDetalleTrasladoPDF(){try{const o=await oo.A.get(`/api/traslado-detalle-pdf/${this.trasladoSeleccionado}`,{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([o.data])),e=document.createElement("a");e.href=a,e.setAttribute("download",`traslado_${this.trasladoSeleccionado}.pdf`),document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(o){console.error("Error al generar el PDF del detalle del traslado:",o),403===o.response?.status?(alert("No tienes permiso para generar PDFs."),this.$router.push("/login")):alert("No se pudo generar el PDF del detalle del traslado.")}},exportarDetalleTrasladoExcel(){if(!this.detalleTraslado.length)return void alert("No hay datos para exportar a Excel.");const o=this.detalleTraslado[0].fecha,a=[["Traslado entre Bodegas"],[`Número Traslado: ${this.trasladoSeleccionado}`],[`Fecha del Traslado: ${o}`],[],["Producto","Cantidad","Bodega Origen","Bodega Destino"]];this.detalleTraslado.forEach((o=>{a.push([o.producto,o.cantidad,o.bodega_origen,o.bodega_destino])}));const e=ao.Wp.aoa_to_sheet(a),r=ao.Wp.book_new();ao.Wp.book_append_sheet(r,e,"Detalle Traslado"),ao._h(r,`traslado_${this.trasladoSeleccionado}.xlsx`)},volverAlMenu(){const o=localStorage.getItem("tipo_usuario");"admin"===o?this.$router.push("/menu"):"gerente"===o?this.$router.push("/menu-gerente"):alert("Rol no reconocido. Contacta al administrador.")},sincronizarPorNombre(){const o=this.productos.find((o=>o.nombre.toLowerCase().includes(this.nombreConsulta.toLowerCase())));o?(this.productoConsulta=o.codigo,this.codigoConsulta=o.codigo):(this.productoConsulta="",this.codigoConsulta="")},sincronizarCodigoConSelector(){const o=this.productos.find((o=>o.codigo===this.codigoConsulta));o?(this.productoConsulta=o.codigo,this.nombreConsulta=o.nombre):(this.productoConsulta="",this.nombreConsulta="")},sincronizarSelectorConCodigo(){const o=this.productos.find((o=>o.codigo===this.productoConsulta));o?(this.codigoConsulta=o.codigo,this.nombreConsulta=o.nombre):(this.codigoConsulta="",this.nombreConsulta="")},sincronizarPorNombreTraslado(){const o=this.productos.find((o=>o.nombre.toLowerCase().includes(this.nombreTraslado.toLowerCase())));o?(this.nuevoTraslado.codigo=o.codigo,this.codigoTraslado=o.codigo):(this.nuevoTraslado.codigo="",this.codigoTraslado="")},sincronizarCodigoConSelectorTraslado(){const o=this.productos.find((o=>o.codigo===this.codigoTraslado));o?(this.nuevoTraslado.codigo=o.codigo,this.nombreTraslado=o.nombre):(this.nuevoTraslado.codigo="",this.nombreTraslado="")},sincronizarSelectorConCodigoTraslado(){const o=this.productos.find((o=>o.codigo===this.nuevoTraslado.codigo));o?(this.nombreTraslado=o.nombre,this.codigoTraslado=o.codigo):(this.nombreTraslado="",this.codigoTraslado="")},sincronizarPorNombreTraslados(){const o=this.productos.find((o=>o.nombre.toLowerCase().includes(this.nombreConsultaTraslados.toLowerCase())));o?(this.filtroProducto=o.codigo,this.codigoConsultaTraslados=o.codigo):(this.filtroProducto="",this.codigoConsultaTraslados="")},sincronizarCodigoConSelectorTraslados(){const o=this.productos.find((o=>o.codigo===this.codigoConsultaTraslados));o?(this.filtroProducto=o.codigo,this.nombreConsultaTraslados=o.nombre):(this.filtroProducto="",this.nombreConsultaTraslados="")},sincronizarSelectorConCodigoTraslados(){const o=this.productos.find((o=>o.codigo===this.filtroProducto));o?(this.codigoConsultaTraslados=o.codigo,this.nombreConsultaTraslados=o.nombre):(this.codigoConsultaTraslados="",this.nombreConsultaTraslados="")}},mounted(){this.cargarProductos(),this.cargarBodegas()}},to=e(1241);const so=(0,to.A)(ro,[["render",Z],["__scopeId","data-v-b06848d2"]]);var lo=so}}]);
//# sourceMappingURL=877.4a2accf5.js.map