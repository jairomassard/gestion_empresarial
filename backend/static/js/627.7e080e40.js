"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[627],{4627:function(a,e,t){t.r(e),t.d(e,{default:function(){return w}});var r=t(6768),l=t(5130),o=t(4232);const c={class:"cargar-compras"},n={class:"menu-buttons"},u={class:"form-section"},s={class:"form-group"},i={class:"form-section"},d={class:"consulta-facturas form-section"},f={class:"form-group"},v={class:"form-group"},p={class:"form-group"},k={class:"form-group"},L=["value"],h={key:0,class:"resultados-facturas form-section"},C={class:"form-actions"},g={class:"table-container"},m=["onClick"],F={key:1,class:"detalle-factura form-section"},b={class:"form-actions"},_={class:"table-container"},y={key:2,class:"form-section"};function E(a,e,t,E,x,A){const N=(0,r.g2)("font-awesome-icon");return(0,r.uX)(),(0,r.CE)("div",c,[e[26]||(e[26]=(0,r.Lk)("h1",null,"Compra de Productos",-1)),(0,r.Lk)("section",n,[(0,r.Lk)("button",{onClick:e[0]||(e[0]=(...a)=>E.limpiarPagina&&E.limpiarPagina(...a)),class:"btn btn-warning"},"Limpiar Página")]),(0,r.Lk)("section",u,[e[12]||(e[12]=(0,r.Lk)("h2",null,"Subir Archivo",-1)),(0,r.Lk)("div",s,[e[11]||(e[11]=(0,r.Lk)("label",{for:"inputCsv"},"Archivo CSV:",-1)),(0,r.Lk)("input",{id:"inputCsv",type:"file",onChange:e[1]||(e[1]=(...a)=>E.cargarCsv&&E.cargarCsv(...a)),ref:"inputCsv"},null,544)]),(0,r.Lk)("button",{onClick:e[2]||(e[2]=(...a)=>E.procesarCsv&&E.procesarCsv(...a))},"Cargar Compras de Productos")]),(0,r.Lk)("section",i,[e[13]||(e[13]=(0,r.Lk)("h2",null,"Descargar Plantilla",-1)),(0,r.Lk)("button",{onClick:e[3]||(e[3]=(...a)=>E.descargarPlantilla&&E.descargarPlantilla(...a))},"Descargar")]),(0,r.Lk)("section",d,[e[19]||(e[19]=(0,r.Lk)("h2",null,"Consulta de Facturas de Compra",-1)),(0,r.Lk)("div",f,[e[14]||(e[14]=(0,r.Lk)("label",{for:"filtroFactura"},"Número de Factura:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>E.filtroFactura=a),id:"filtroFactura",placeholder:"Ingrese número de factura"},null,512),[[l.Jo,E.filtroFactura]])]),(0,r.Lk)("div",v,[e[15]||(e[15]=(0,r.Lk)("label",{for:"fechaInicio"},"Fecha Inicio:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"date","onUpdate:modelValue":e[5]||(e[5]=a=>E.fechaInicio=a),id:"fechaInicio"},null,512),[[l.Jo,E.fechaInicio]])]),(0,r.Lk)("div",p,[e[16]||(e[16]=(0,r.Lk)("label",{for:"fechaFin"},"Fecha Fin:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"date","onUpdate:modelValue":e[6]||(e[6]=a=>E.fechaFin=a),id:"fechaFin"},null,512),[[l.Jo,E.fechaFin]])]),(0,r.Lk)("div",k,[e[18]||(e[18]=(0,r.Lk)("label",{for:"selectorFactura"},"Seleccionar Factura:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>E.filtroFactura=a),id:"selectorFactura"},[e[17]||(e[17]=(0,r.Lk)("option",{value:"",disabled:""},"Seleccione una factura",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(E.facturas,(a=>((0,r.uX)(),(0,r.CE)("option",{key:a,value:a},(0,o.v_)(a),9,L)))),128))],512),[[l.u1,E.filtroFactura]])]),(0,r.Lk)("button",{onClick:e[8]||(e[8]=(...a)=>E.consultarFacturas&&E.consultarFacturas(...a))},"Consultar Facturas")]),E.resultadosFacturas.length?((0,r.uX)(),(0,r.CE)("section",h,[e[22]||(e[22]=(0,r.Lk)("h3",null,"Resultados de la Consulta",-1)),(0,r.Lk)("div",C,[(0,r.Lk)("button",{onClick:e[9]||(e[9]=(...a)=>E.exportarListadoExcel&&E.exportarListadoExcel(...a))},[e[20]||(e[20]=(0,r.eW)("Exportar Listado ")),(0,r.bF)(N,{icon:"file-excel",class:"excel-icon"})])]),(0,r.Lk)("div",g,[(0,r.Lk)("table",null,[e[21]||(e[21]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Número de Factura"),(0,r.Lk)("th",null,"Fecha y Hora"),(0,r.Lk)("th",null,"Acción")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(E.resultadosFacturas,(a=>((0,r.uX)(),(0,r.CE)("tr",{key:a.factura},[(0,r.Lk)("td",null,(0,o.v_)(a.factura),1),(0,r.Lk)("td",null,(0,o.v_)(a.fecha),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{onClick:e=>E.verDetalleFactura(a.factura),class:"btn btn-info"},"Detalle",8,m)])])))),128))])])])])):(0,r.Q3)("",!0),E.detalleFactura.length?((0,r.uX)(),(0,r.CE)("section",F,[(0,r.Lk)("h3",null,"Detalle de la Factura de Compra "+(0,o.v_)(E.facturaSeleccionada),1),(0,r.Lk)("div",b,[(0,r.Lk)("button",{onClick:e[10]||(e[10]=(...a)=>E.exportarDetalleExcel&&E.exportarDetalleExcel(...a))},[e[23]||(e[23]=(0,r.eW)("Exportar ")),(0,r.bF)(N,{icon:"file-excel",class:"excel-icon"})])]),(0,r.Lk)("div",_,[(0,r.Lk)("table",null,[e[24]||(e[24]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Código"),(0,r.Lk)("th",null,"Nombre"),(0,r.Lk)("th",null,"Cantidad"),(0,r.Lk)("th",null,"Bodega"),(0,r.Lk)("th",null,"Costo Unitario"),(0,r.Lk)("th",null,"Costo Total")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(E.detalleFactura,(a=>((0,r.uX)(),(0,r.CE)("tr",{key:a.id},[(0,r.Lk)("td",null,(0,o.v_)(a.codigo),1),(0,r.Lk)("td",null,(0,o.v_)(a.nombre),1),(0,r.Lk)("td",null,(0,o.v_)(a.cantidad),1),(0,r.Lk)("td",null,(0,o.v_)(a.bodega),1),(0,r.Lk)("td",null,(0,o.v_)(a.costo_unitario?`$${a.costo_unitario.toFixed(2)}`:"N/A"),1),(0,r.Lk)("td",null,(0,o.v_)(a.costo_total?`$${a.costo_total.toFixed(2)}`:"N/A"),1)])))),128))])])])])):(0,r.Q3)("",!0),E.errores.length?((0,r.uX)(),(0,r.CE)("section",y,[e[25]||(e[25]=(0,r.Lk)("h2",null,"Errores Detectados:",-1)),(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(E.errores,((a,e)=>((0,r.uX)(),(0,r.CE)("li",{key:e},(0,o.v_)(a),1)))),128))])])):(0,r.Q3)("",!0)])}t(4114),t(8111),t(116),t(1701),t(4603),t(7566),t(8721);var x=t(144),A=t(1387),N=t(7682),R=t(3230),K={name:"CargarComprasProducto",setup(){const a=(0,A.rd)(),e=(0,x.KR)(null),t=(0,x.KR)(null),l=(0,x.KR)([]),o=(0,x.KR)(""),c=(0,x.KR)(""),n=(0,x.KR)(""),u=(0,x.KR)([]),s=(0,x.KR)([]),i=(0,x.KR)([]),d=(0,x.KR)(""),f=a=>{e.value=a.target.files[0]},v=async()=>{if(!e.value)return void alert("Seleccione un archivo para cargar");const a=new FormData;a.append("file",e.value);try{const e=await N.A.post("/inventory/cargar-compras",a);alert(e.data.message),l.value=[],C(),L()}catch(t){console.error("Error al cargar compras:",t),t.response?.data?.errors?l.value=t.response.data.errors:alert("Ocurrió un error al cargar las compras.")}},p=()=>{const a=[["factura","codigo","nombre","cantidad","bodega","contenedor","fecha_ingreso","costo_unitario"],["FAC001","GRA05299901000000","R5 BULK PASTEL YELLOW","100","Bodega1","CONT001","2024-12-01 10:00:00","50.00"],["ABC123","GRA05299909000000","R5 BULK PASTEL LIGTH PINK","150","Bodega2","CONT002","2024-12-01 10:30:00","45.00"]],e=a.map((a=>a.join(","))).join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(t),r.setAttribute("download","plantilla_cargue_compras.csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r)},k=()=>{a.push("/inventory")},L=()=>{e.value=null,t.value&&(t.value.value="")},h=()=>{L(),l.value=[],o.value="",c.value="",n.value="",s.value=[],i.value=[],d.value=""},C=async()=>{try{const a=await N.A.get("/inventory/facturas");u.value=a.data.facturas}catch(a){console.error("Error al cargar facturas:",a),alert("Ocurrió un error al cargar las facturas.")}},g=async()=>{try{const a={factura:o.value||void 0,fecha_inicio:c.value||void 0,fecha_fin:n.value||void 0},e=await N.A.get("/inventory/consultar-facturas",{params:a});s.value=e.data,i.value=[]}catch(a){console.error("Error al consultar facturas:",a),alert("Ocurrió un error al consultar las facturas.")}},m=async a=>{try{d.value=a;const e=await N.A.get("/inventory/detalle-factura",{params:{factura:a}});i.value=e.data}catch(e){console.error("Error al obtener detalle de factura:",e),alert("No se pudo recuperar el detalle de la factura.")}},F=()=>{if(!s.value.length)return void alert("No hay datos para exportar a Excel.");const a=[["Resultado de consulta de Facturas de Compras Cargadas"],[`Número de Factura: ${o.value||"Todos"}`],[`Fecha Inicio: ${c.value||"No especificada"}`],[`Fecha Fin: ${n.value||"No especificada"}`],[],["Número de Factura","Fecha y Hora"],...s.value.map((a=>[a.factura,a.fecha]))],e=R.Wp.aoa_to_sheet(a),t=R.Wp.book_new();R.Wp.book_append_sheet(t,e,"Facturas"),R._h(t,`facturas_compras_${(new Date).toISOString().slice(0,10)}.xlsx`)},b=()=>{if(!i.value.length)return void alert("No hay datos para exportar a Excel.");const a=s.value.find((a=>a.factura===d.value))?.fecha||"Desconocida",e=[[`Detalle Factura ${d.value}`],[`Fecha de Cargue: ${a}`],[],["Código","Nombre","Cantidad","Bodega","Costo Unitario","Costo Total"],...i.value.map((a=>[a.codigo,a.nombre,a.cantidad,a.bodega,a.costo_unitario||"N/A",a.costo_total||"N/A"]))],t=R.Wp.aoa_to_sheet(e),r=R.Wp.book_new();R.Wp.book_append_sheet(r,t,"Detalle Factura"),R._h(r,`detalle_factura_${d.value}.xlsx`)};return(0,r.sV)((()=>{C()})),{archivoCsv:e,inputCsv:t,errores:l,filtroFactura:o,fechaInicio:c,fechaFin:n,facturas:u,resultadosFacturas:s,detalleFactura:i,facturaSeleccionada:d,cargarCsv:f,procesarCsv:v,descargarPlantilla:p,volverAlMenu:k,limpiarPagina:h,cargarFacturas:C,consultarFacturas:g,verDetalleFactura:m,exportarListadoExcel:F,exportarDetalleExcel:b}}},I=t(1241);const D=(0,I.A)(K,[["render",E],["__scopeId","data-v-0f2eebf9"]]);var w=D}}]);
//# sourceMappingURL=627.7e080e40.js.map