"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[625],{9625:function(o,a,e){e.r(a),e.d(a,{default:function(){return mo}});var r=e(6768),t=e(5130),i=e(4232);const s={class:"gestion-productos-materiales"},l={class:"top-buttons"},c={class:"carga-csv"},n={key:0,class:"spinner-container"},d={class:"carga-input"},u=["disabled"],p=["disabled"],m={class:"carga-links"},v={key:1,class:"error-container"},g={key:2,class:"modal-instructivo"},b={class:"modal-contenido"},k={class:"carga-csv"},C={key:0,class:"spinner-container"},_={class:"carga-input"},L=["disabled"],h=["disabled"],P={class:"carga-links"},f={key:1,class:"error-container"},y={key:2,class:"modal-instructivo"},E={class:"modal-contenido"},A={class:"form-section"},z={class:"form-group"},S=["disabled"],M={class:"form-group"},V={class:"form-group"},N={class:"form-group"},R={class:"form-group"},D=["required","disabled"],U={class:"form-group"},w=["required","disabled"],x={class:"form-group"},I={class:"form-actions"},$={key:0,type:"submit"},K={key:0,class:"materiales-section"},B={class:"table-container"},q=["onUpdate:modelValue","onInput"],X=["onUpdate:modelValue","onChange"],j=["value"],T=["onUpdate:modelValue","onInput"],G=["onUpdate:modelValue","onInput"],J=["onClick"],F={class:"materiales-actions"},O={class:"consulta-productos"},Q={class:"filters"},W={class:"filter-group"},H={class:"filter-group"},Y={class:"filter-group"},Z={class:"filter-actions"},oo={key:0,class:"table-container"},ao=["onClick"],eo=["onClick"];function ro(o,a,e,ro,to,io){return(0,r.uX)(),(0,r.CE)("div",s,[a[64]||(a[64]=(0,r.Lk)("h1",null,"Gesti√≥n de Productos y Materiales",-1)),(0,r.Lk)("div",l,[(0,r.Lk)("button",{onClick:a[0]||(a[0]=(...o)=>ro.limpiarPagina&&ro.limpiarPagina(...o)),class:"btn btn-warning"},"Limpiar P√°gina")]),(0,r.Lk)("section",c,[a[40]||(a[40]=(0,r.Lk)("h2",null,"Cargar Productos desde archivo .CSV",-1)),ro.isLoadingCarga?((0,r.uX)(),(0,r.CE)("div",n,a[37]||(a[37]=[(0,r.Lk)("div",{class:"spinner"},null,-1),(0,r.Lk)("p",null,"Procesando archivo CSV, por favor espera...",-1)]))):(0,r.Q3)("",!0),(0,r.Lk)("div",d,[(0,r.Lk)("input",{type:"file",accept:".csv",onChange:a[1]||(a[1]=(...o)=>ro.cargarCsv&&ro.cargarCsv(...o)),ref:"inputCsv"},null,544),(0,r.Lk)("button",{onClick:a[2]||(a[2]=(...o)=>ro.procesarCsv&&ro.procesarCsv(...o)),disabled:ro.isLoadingCarga},"Subir",8,u),(0,r.Lk)("button",{onClick:a[3]||(a[3]=(...o)=>ro.limpiarSesionCsv&&ro.limpiarSesionCsv(...o)),disabled:ro.isLoadingCarga,class:"btn-warning"},"Limpiar Sesi√≥n",8,p)]),(0,r.Lk)("div",m,[(0,r.Lk)("a",{onClick:a[4]||(a[4]=(...o)=>ro.descargarPlantillaCSV&&ro.descargarPlantillaCSV(...o)),class:"link-descarga"},"üì• Descargar Plantilla CSV"),(0,r.Lk)("a",{onClick:a[5]||(a[5]=(...o)=>ro.mostrarInstructivo&&ro.mostrarInstructivo(...o)),class:"link-instructivo"},"üìñ Instructivo de Uso")]),ro.erroresCsv?((0,r.uX)(),(0,r.CE)("div",v,[a[38]||(a[38]=(0,r.Lk)("h3",null,"Errores Detectados",-1)),(0,r.bo)((0,r.Lk)("textarea",{readonly:"","onUpdate:modelValue":a[6]||(a[6]=o=>ro.erroresCsv=o)},null,512),[[t.Jo,ro.erroresCsv]]),(0,r.Lk)("button",{onClick:a[7]||(a[7]=(...o)=>ro.copiarErrores&&ro.copiarErrores(...o))},"Copiar errores")])):(0,r.Q3)("",!0),ro.mostrarModal?((0,r.uX)(),(0,r.CE)("div",g,[(0,r.Lk)("div",b,[a[39]||(a[39]=(0,r.Fv)("<h3 data-v-911abece>üìÑ Instructivo de Uso para Carga de Productos</h3><p data-v-911abece>1Ô∏è‚É£ <strong data-v-911abece>C√≥digo</strong>: C√≥digo √∫nico del producto. No debe repetirse.</p><p data-v-911abece>2Ô∏è‚É£ <strong data-v-911abece>Nombre</strong>: Nombre del producto.</p><p data-v-911abece>3Ô∏è‚É£ <strong data-v-911abece>Peso Total / Unidad</strong>: Obligatorio solo para productos Base.</p><p data-v-911abece>4Ô∏è‚É£ <strong data-v-911abece>C√≥digo de Barras</strong>: C√≥digo de barras opcional.</p><p data-v-911abece>5Ô∏è‚É£ <strong data-v-911abece>Es Producto Compuesto</strong>: &quot;S√≠&quot; si el producto es compuesto, &quot;No&quot; si es producto Base.</p><p data-v-911abece>6Ô∏è‚É£ <strong data-v-911abece>Stock M√≠nimo</strong>: Cantidad m√≠nima de inventario (opcional, n√∫mero entero o decimal).</p><p data-v-911abece>7Ô∏è‚É£ <strong data-v-911abece>Cantidad Productos</strong>: Si el producto es Base, se coloca 0. Si es compuesto, indicar cu√°ntos productos lo conforman.</p><p data-v-911abece>8Ô∏è‚É£ <strong data-v-911abece>C√≥digo y Cantidad de Productos Compuestos</strong>: Se deben indicar los c√≥digos y cantidades de los productos compuestos.</p>",9)),(0,r.Lk)("button",{onClick:a[8]||(a[8]=(...o)=>ro.cerrarModal&&ro.cerrarModal(...o)),class:"btn-cerrar"},"Cerrar")])])):(0,r.Q3)("",!0)]),(0,r.Lk)("section",k,[a[44]||(a[44]=(0,r.Lk)("h2",null,"Actualizaci√≥n Masiva de Productos desde archivo .CSV",-1)),ro.isLoadingActualizar?((0,r.uX)(),(0,r.CE)("div",C,a[41]||(a[41]=[(0,r.Lk)("div",{class:"spinner"},null,-1),(0,r.Lk)("p",null,"Procesando archivo CSV de actualizaci√≥n, por favor espera...",-1)]))):(0,r.Q3)("",!0),(0,r.Lk)("div",_,[(0,r.Lk)("input",{type:"file",accept:".csv",onChange:a[9]||(a[9]=(...o)=>ro.cargarArchivoActualizarCsv&&ro.cargarArchivoActualizarCsv(...o)),ref:"inputActualizarCsv"},null,544),(0,r.Lk)("button",{onClick:a[10]||(a[10]=(...o)=>ro.procesarActualizacionCsv&&ro.procesarActualizacionCsv(...o)),disabled:!ro.archivoActualizarCsv||ro.isLoadingActualizar},"Subir",8,L),(0,r.Lk)("button",{onClick:a[11]||(a[11]=(...o)=>ro.limpiarActualizarCsv&&ro.limpiarActualizarCsv(...o)),disabled:!ro.archivoActualizarCsv||ro.isLoadingActualizar,class:"btn-warning"},"Limpiar Sesi√≥n",8,h)]),(0,r.Lk)("div",P,[(0,r.Lk)("a",{onClick:a[12]||(a[12]=(...o)=>ro.descargarPlantillaActualizarCSV&&ro.descargarPlantillaActualizarCSV(...o)),class:"link-descarga"},"üì• Descargar Plantilla CSV"),(0,r.Lk)("a",{onClick:a[13]||(a[13]=(...o)=>ro.mostrarInstructivoActualizar&&ro.mostrarInstructivoActualizar(...o)),class:"link-instructivo"},"üìñ Instructivo de Uso")]),ro.erroresActualizarCsv?((0,r.uX)(),(0,r.CE)("div",f,[a[42]||(a[42]=(0,r.Lk)("h3",null,"Errores Detectados",-1)),(0,r.bo)((0,r.Lk)("textarea",{readonly:"","onUpdate:modelValue":a[14]||(a[14]=o=>ro.erroresActualizarCsv=o)},null,512),[[t.Jo,ro.erroresActualizarCsv]]),(0,r.Lk)("button",{onClick:a[15]||(a[15]=(...o)=>ro.copiarErroresActualizar&&ro.copiarErroresActualizar(...o))},"Copiar errores")])):(0,r.Q3)("",!0),ro.mostrarModalActualizar?((0,r.uX)(),(0,r.CE)("div",y,[(0,r.Lk)("div",E,[a[43]||(a[43]=(0,r.Fv)("<h3 data-v-911abece>üìÑ Instructivo para Actualizar Productos desde CSV</h3><p data-v-911abece>1Ô∏è‚É£ <strong data-v-911abece>C√≥digo</strong>: C√≥digo del producto existente (obligatorio).</p><p data-v-911abece>2Ô∏è‚É£ <strong data-v-911abece>Nombre</strong>: Nuevo nombre del producto (debe ser √∫nico).</p><p data-v-911abece>3Ô∏è‚É£ <strong data-v-911abece>Peso Total (gr)</strong>: Peso total para productos base.</p><p data-v-911abece>4Ô∏è‚É£ <strong data-v-911abece>Peso Unidad (gr)</strong>: Peso por unidad para productos base.</p><p data-v-911abece>5Ô∏è‚É£ <strong data-v-911abece>C√≥digo de Barras</strong>: C√≥digo de barras (opcional).</p><p data-v-911abece>6Ô∏è‚É£ <strong data-v-911abece>Es Producto Compuesto</strong>: &quot;S√≠&quot; o &quot;No&quot;.</p><p data-v-911abece>7Ô∏è‚É£ <strong data-v-911abece>Stock M√≠nimo</strong>: N√∫mero entero o vac√≠o (opcional).</p><p data-v-911abece>8Ô∏è‚É£ <strong data-v-911abece>Cantidad Productos</strong>: N√∫mero de productos base para compuestos.</p><p data-v-911abece>9Ô∏è‚É£ <strong data-v-911abece>C√≥digo1, Cantidad1, etc.</strong>: Materiales para productos compuestos.</p><p data-v-911abece>üìù <strong data-v-911abece>Notas</strong>:</p><p data-v-911abece>- Los campos vac√≠os no modificar√°n los valores existentes.</p><p data-v-911abece>- Los productos base deben existir previamente en el sistema.</p><p data-v-911abece>- El campo nombre debe ser √∫nico en el sistema.</p>",14)),(0,r.Lk)("button",{onClick:a[16]||(a[16]=(...o)=>ro.cerrarModalActualizar&&ro.cerrarModalActualizar(...o)),class:"btn-cerrar"},"Cerrar")])])):(0,r.Q3)("",!0)]),(0,r.Lk)("section",A,[(0,r.Lk)("h2",null,(0,i.v_)(ro.modoEdicion?"Editar Producto":"Crear Producto"),1),(0,r.Lk)("form",{onSubmit:a[26]||(a[26]=(0,t.D$)((o=>ro.modoEdicion?ro.actualizarProducto():ro.crearProducto()),["prevent"]))},[(0,r.Lk)("div",z,[a[45]||(a[45]=(0,r.Lk)("label",{for:"codigo"},"C√≥digo del Producto:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[17]||(a[17]=o=>ro.producto.codigo=o),id:"codigo",required:"",disabled:ro.modoEdicion},null,8,S),[[t.Jo,ro.producto.codigo]])]),(0,r.Lk)("div",M,[a[46]||(a[46]=(0,r.Lk)("label",{for:"nombre"},"Nombre del Producto:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[18]||(a[18]=o=>ro.producto.nombre=o),id:"nombre",required:""},null,512),[[t.Jo,ro.producto.nombre]])]),(0,r.Lk)("div",V,[a[47]||(a[47]=(0,r.Lk)("label",{for:"codigo_barras"},"C√≥digo de Barras:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[19]||(a[19]=o=>ro.producto.codigo_barras=o),id:"codigo_barras"},null,512),[[t.Jo,ro.producto.codigo_barras]])]),(0,r.Lk)("div",N,[a[49]||(a[49]=(0,r.Lk)("label",null,"Tipo de Producto:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":a[20]||(a[20]=o=>ro.producto.es_producto_compuesto=o)},a[48]||(a[48]=[(0,r.Lk)("option",{value:!1},"Base",-1),(0,r.Lk)("option",{value:!0},"Compuesto",-1)]),512),[[t.u1,ro.producto.es_producto_compuesto]])]),(0,r.Lk)("div",R,[a[50]||(a[50]=(0,r.Lk)("label",{for:"peso_total"},"Peso Total en Gramos:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[21]||(a[21]=o=>ro.producto.peso_total_gr=o),id:"peso_total",type:"number",step:"0.01",required:!ro.producto.es_producto_compuesto,disabled:ro.producto.es_producto_compuesto},null,8,D),[[t.Jo,ro.producto.peso_total_gr,void 0,{number:!0}]])]),(0,r.Lk)("div",U,[a[51]||(a[51]=(0,r.Lk)("label",{for:"peso_unidad"},"Peso por Unidad en Gramos:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[22]||(a[22]=o=>ro.producto.peso_unidad_gr=o),id:"peso_unidad",type:"number",step:"0.01",required:!ro.producto.es_producto_compuesto,disabled:ro.producto.es_producto_compuesto},null,8,w),[[t.Jo,ro.producto.peso_unidad_gr,void 0,{number:!0}]])]),(0,r.Lk)("div",x,[a[52]||(a[52]=(0,r.Lk)("label",{for:"stock_minimo"},"Stock M√≠nimo:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[23]||(a[23]=o=>ro.producto.stock_minimo=o),id:"stock_minimo",type:"number",min:"0"},null,512),[[t.Jo,ro.producto.stock_minimo,void 0,{number:!0}]])]),(0,r.Lk)("div",I,[ro.modoEdicion?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[a[53]||(a[53]=(0,r.Lk)("button",{type:"submit"},"Guardar Producto",-1)),(0,r.Lk)("button",{type:"button",onClick:a[24]||(a[24]=(...o)=>ro.cancelarEdicion&&ro.cancelarEdicion(...o))},"Cancelar"),(0,r.Lk)("button",{type:"button",onClick:a[25]||(a[25]=(...o)=>ro.limpiarSesion&&ro.limpiarSesion(...o)),class:"btn-warning"},"Limpiar Sesi√≥n")],64)):((0,r.uX)(),(0,r.CE)("button",$,"Crear Producto"))])],32)]),ro.producto.es_producto_compuesto&&ro.producto.id?((0,r.uX)(),(0,r.CE)("section",K,[a[56]||(a[56]=(0,r.Lk)("h2",null,"Materiales del Producto",-1)),(0,r.Lk)("div",B,[(0,r.Lk)("table",null,[a[55]||(a[55]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Producto Base"),(0,r.Lk)("th",null,"Cantidad"),(0,r.Lk)("th",null,"Peso Unitario (g)"),(0,r.Lk)("th",null,"Peso Total (g)"),(0,r.Lk)("th",null,"Acciones")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(ro.materiales,((o,e)=>((0,r.uX)(),(0,r.CE)("tr",{key:e},[(0,r.Lk)("td",null,[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":a=>o.nombreDigitado=a,placeholder:"Buscar por nombre",onInput:o=>ro.sincronizarPorNombre(e)},null,40,q),[[t.Jo,o.nombreDigitado]]),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":a=>o.producto_base=a,onChange:o=>ro.sincronizarCodigo(e)},[a[54]||(a[54]=(0,r.Lk)("option",{value:null,disabled:""},"Seleccione un producto",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(ro.productosDisponibles,(o=>((0,r.uX)(),(0,r.CE)("option",{key:o.id,value:o.id},(0,i.v_)(o.codigo)+" - "+(0,i.v_)(o.nombre),9,j)))),128))],40,X),[[t.u1,o.producto_base]]),(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":a=>o.codigoDigitado=a,placeholder:"Ingrese c√≥digo del material",onInput:o=>ro.sincronizarSelector(e)},null,40,T),[[t.Jo,o.codigoDigitado]])]),(0,r.Lk)("td",null,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a=>o.cantidad=a,type:"number",step:"0.01",min:"0.01",required:"",onInput:o=>ro.actualizarPesoMaterial(e)},null,40,G),[[t.Jo,o.cantidad,void 0,{number:!0}]])]),(0,r.Lk)("td",null,(0,i.v_)(o.peso_unitario),1),(0,r.Lk)("td",null,(0,i.v_)(o.peso_total),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{onClick:(0,t.D$)((o=>ro.eliminarMaterial(e)),["prevent"])},"Eliminar",8,J)])])))),128))])])]),(0,r.Lk)("div",F,[(0,r.Lk)("button",{onClick:a[27]||(a[27]=(0,t.D$)(((...o)=>ro.agregarMaterial&&ro.agregarMaterial(...o)),["prevent"]))},"Agregar Material"),(0,r.Lk)("button",{onClick:a[28]||(a[28]=(0,t.D$)(((...o)=>ro.guardarMateriales&&ro.guardarMateriales(...o)),["prevent"]))},"Guardar Materiales")])])):(0,r.Q3)("",!0),(0,r.Lk)("section",O,[a[63]||(a[63]=(0,r.Lk)("h2",null,"Consulta de Productos Creados",-1)),(0,r.Lk)("div",Q,[(0,r.Lk)("div",W,[a[57]||(a[57]=(0,r.Lk)("label",{for:"buscarCodigo"},"Buscar por C√≥digo:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[29]||(a[29]=o=>ro.filtroCodigo=o),id:"buscarCodigo",placeholder:"Ingrese c√≥digo de producto"},null,512),[[t.Jo,ro.filtroCodigo]])]),(0,r.Lk)("div",H,[a[58]||(a[58]=(0,r.Lk)("label",{for:"buscarNombre"},"Buscar por Nombre:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[30]||(a[30]=o=>ro.filtroNombre=o),id:"buscarNombre",placeholder:"Ingrese nombre o parte del nombre"},null,512),[[t.Jo,ro.filtroNombre]])]),(0,r.Lk)("div",Y,[a[60]||(a[60]=(0,r.Lk)("label",{for:"limit"},"Mostrar:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":a[31]||(a[31]=o=>ro.limit=o),id:"limit",onChange:a[32]||(a[32]=(...o)=>ro.consultarProductos&&ro.consultarProductos(...o))},a[59]||(a[59]=[(0,r.Fv)('<option value="10" data-v-911abece>10</option><option value="20" data-v-911abece>20</option><option value="50" data-v-911abece>50</option><option value="100" data-v-911abece>100</option><option value="0" data-v-911abece>Todos</option>',5)]),544),[[t.u1,ro.limit]]),a[61]||(a[61]=(0,r.Lk)("span",null," productos",-1))]),(0,r.Lk)("div",Z,[(0,r.Lk)("button",{onClick:a[33]||(a[33]=(...o)=>ro.consultarProductos&&ro.consultarProductos(...o))},"Consultar Productos"),(0,r.Lk)("button",{onClick:a[34]||(a[34]=(...o)=>ro.limpiarCampos&&ro.limpiarCampos(...o)),class:"btn-warning"},"Limpiar Campos"),(0,r.Lk)("button",{onClick:a[35]||(a[35]=(...o)=>ro.exportarAExcel&&ro.exportarAExcel(...o)),class:"btn-export"},"Exportar a Excel")])]),ro.productos.length?((0,r.uX)(),(0,r.CE)("div",oo,[(0,r.Lk)("table",null,[a[62]||(a[62]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"C√≥digo"),(0,r.Lk)("th",null,"Nombre"),(0,r.Lk)("th",null,"Peso Total (g)"),(0,r.Lk)("th",null,"Peso Unidad (g)"),(0,r.Lk)("th",null,"C√≥digo de Barras"),(0,r.Lk)("th",null,"Prod. Compuesto"),(0,r.Lk)("th",null,"Stock M√≠nimo"),(0,r.Lk)("th",null,"Acciones")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(ro.productos,(o=>((0,r.uX)(),(0,r.CE)("tr",{key:o.id},[(0,r.Lk)("td",null,(0,i.v_)(o.codigo),1),(0,r.Lk)("td",null,(0,i.v_)(o.nombre),1),(0,r.Lk)("td",null,(0,i.v_)(o.peso_total_gr),1),(0,r.Lk)("td",null,(0,i.v_)(o.peso_unidad_gr),1),(0,r.Lk)("td",null,(0,i.v_)(o.codigo_barras),1),(0,r.Lk)("td",null,(0,i.v_)(o.es_producto_compuesto?"S√≠":"No"),1),(0,r.Lk)("td",null,(0,i.v_)(null!==o.stock_minimo?o.stock_minimo:"-"),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{onClick:a=>ro.editarProducto(o)},"Editar",8,ao),(0,r.Lk)("button",{onClick:a=>ro.eliminarProducto(o.id)},"Eliminar",8,eo)])])))),128))])]),ro.productos.length<ro.totalProductos?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:a[36]||(a[36]=(...o)=>ro.cargarMasProductos&&ro.cargarMasProductos(...o))},"Cargar m√°s productos")):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0)])])}e(4114),e(8111),e(2489),e(116),e(1701),e(3579),e(4603),e(7566),e(8721);var to=e(144),io=e(782),so=e(1387),lo=e(7682),co=e(3230),no={name:"GestionProductosMateriales",setup(){(0,io.Pj)();const o=(0,so.rd)(),a=(0,to.KR)({id:null,codigo:"",nombre:"",es_producto_compuesto:!1,stock_minimo:null}),e=(0,to.KR)([]),r=(0,to.KR)([]),t=(0,to.KR)([]),i=(0,to.KR)(!1),s=(0,to.KR)(""),l=(0,to.KR)(""),c=(0,to.KR)(0),n=(0,to.KR)(0),d=(0,to.KR)(50),u=(0,to.KR)(null),p=(0,to.KR)(null),m=(0,to.KR)(""),v=(0,to.KR)(""),g=(0,to.KR)(!1),b=(0,to.KR)(!1),k=(0,to.KR)(!1),C=(0,to.KR)(!1),_=(0,to.KR)(null),L=(0,to.KR)(null),h=async()=>{try{const o={...a.value};o.es_producto_compuesto&&(delete o.peso_total_gr,delete o.peso_unidad_gr);const e=await lo.A.post("/inventory/productos",o);a.value.id=e.data.id,alert("Producto creado correctamente"),I(),P()}catch(o){console.error("Error al crear producto:",o),alert(o.response?.data?.error||"Error al crear producto")}},P=async()=>{try{const o=0===d.value?1e4:d.value,a={offset:n.value,limit:o,search_codigo:s.value||"",search_nombre:l.value||""},r=await lo.A.get("/inventory/productos",{params:a});e.value=r.data.productos.sort(((o,a)=>o.codigo.localeCompare(a.codigo))),c.value=r.data.total}catch(o){console.error("Error al cargar productos:",o),alert("Ocurri√≥ un error al consultar los productos.")}},f=async()=>{if(a.value.id&&a.value.es_producto_compuesto)try{const o=await lo.A.get(`/inventory/materiales-producto/${a.value.id}`);r.value=o.data.materiales.map((o=>{const a=t.value.find((a=>a.id===o.producto_base_id));return{id:o.id,producto_base:o.producto_base_id,codigoDigitado:a?a.codigo:"",nombreDigitado:a?a.nombre:"",cantidad:o.cantidad,peso_unitario:a?a.peso_unidad_gr:0,peso_total:o.cantidad*(a?a.peso_unidad_gr:0)}}))}catch(o){console.error("Error al cargar materiales:",o),alert("No se pudieron cargar los materiales del producto compuesto.")}},y=async()=>{try{const o=await lo.A.get("/inventory/productos",{params:{limit:500}});t.value=o.data.productos.sort(((o,a)=>o.codigo.localeCompare(a.codigo)))}catch(a){console.error("Error al cargar productos disponibles:",a),401===a.response?.status?o.push("/login"):alert("No se pudieron cargar los productos disponibles.")}},E=async()=>{try{if(r.value.some((o=>!o.producto_base||isNaN(o.cantidad)||o.cantidad<=0)))return void alert("Todos los materiales deben tener un producto base seleccionado y una cantidad v√°lida mayor a 0.");const o={producto_compuesto_id:a.value.id,materiales:r.value.map((o=>({producto_base_id:o.producto_base,cantidad:Number(o.cantidad)})))};await lo.A.post("/inventory/materiales-producto",o),alert("Materiales guardados correctamente"),f()}catch(o){console.error("Error al guardar materiales:",o),alert("Hubo un problema guardando los materiales.")}},A=async()=>{try{n.value+=d.value;const o=await lo.A.get("/inventory/productos",{params:{offset:n.value,limit:d.value}});e.value=[...e.value,...o.data.productos.sort(((o,a)=>o.codigo.localeCompare(a.codigo)))]}catch(o){console.error("Error al cargar m√°s productos:",o)}},z=o=>{u.value=o.target.files[0],m.value=""},S=async()=>{if(u.value){k.value=!0;try{const o=new FormData;o.append("file",u.value);const a=await lo.A.post("/inventory/productos/csv",o,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4}),{message:e,productos_creados:r,productos_duplicados:t,errores:i}=a.data;let s=`${e}\n\n`;r.length&&(s+=`‚úî Productos creados: ${r.join(", ")}\n`),t.length&&(s+=`‚ö†Ô∏è Productos duplicados: ${t.join(", ")}\n`),i.length&&(s+=`üõë Errores detectados:\n- ${i.join("\n- ")}\n`),alert(s),m.value=i.length||t.length?`‚ö†Ô∏è Reporte de errores:\n\n${t.length?`üîπ Productos duplicados:\n- ${t.join("\n- ")}\n\n`:""}${i.length?`üõë Errores:\n- ${i.join("\n- ")}\n`:""}`:"",P(),F()}catch(o){console.error("Error al cargar archivo CSV:",o);let a="‚ùå Error al cargar el archivo CSV.";"ECONNABORTED"===o.code?a+=" La solicitud tard√≥ demasiado. Intenta con un archivo m√°s peque√±o.":o.response&&(a+=` Detalles: ${o.response.data.error||"Error desconocido"}`),alert(a)}finally{k.value=!1}}else alert("Por favor, selecciona un archivo CSV.")},M=o=>{p.value=o.target.files[0],v.value=""},V=async()=>{if(p.value){C.value=!0;try{const o=new FormData;o.append("file",p.value);const a=await lo.A.post("/inventory/productos/actualizar-csv",o,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4}),{message:e,productos_actualizados:r,productos_no_encontrados:t,errores:i}=a.data;let s=`‚úÖ ${e}\n\n`;r.length&&(s+=`‚úî Productos actualizados: ${r.join(", ")}\n`),t.length&&(s+=`‚ö†Ô∏è Productos no encontrados: ${t.join(", ")}\n`),i.length&&(s+=`üõë Errores detectados:\n- ${i.join("\n- ")}\n`),alert(s),v.value=i.length||t.length?`‚ö†Ô∏è Reporte de errores:\n\n${t.length?`üîπ Productos no encontrados:\n- ${t.join("\n- ")}\n\n`:""}${i.length?`üõë Errores:\n- ${i.join("\n- ")}\n`:""}`:"",P(),O()}catch(o){console.error("Error al actualizar productos desde CSV:",o);let a="‚ùå Error al actualizar productos desde CSV.";"ECONNABORTED"===o.code?a+=" La solicitud tard√≥ demasiado. Intenta con un archivo m√°s peque√±o.":o.response&&(a+=` Detalles: ${o.response.data.error||"Error desconocido"}`),alert(a)}finally{C.value=!1}}else alert("Por favor, selecciona un archivo CSV para actualizar.")},N=o=>{const a=r.value[o],e=t.value.find((o=>o.codigo===a.codigoDigitado));e&&(a.producto_base=e.id,a.nombreDigitado=e.nombre,B(o))},R=o=>{const a=r.value[o],e=t.value.find((o=>o.id===a.producto_base));e&&(a.codigoDigitado=e.codigo,a.nombreDigitado=e.nombre,B(o))},D=o=>{const a=r.value[o];if(!a.nombreDigitado)return;const e=t.value.find((o=>o.nombre.toLowerCase().includes(a.nombreDigitado.toLowerCase())));e?(a.producto_base=e.id,a.codigoDigitado=e.codigo,B(o)):a.producto_base=null},U=o=>{i.value=!0,a.value={...o},y().then((()=>f()))},w=async()=>{try{await lo.A.put(`/inventory/productos/${a.value.id}`,a.value),alert("Producto actualizado correctamente"),P(),x()}catch(o){console.error("Error al actualizar producto:",o),alert("Error al actualizar producto")}},x=()=>{i.value=!1,I(),P()},I=()=>{a.value={id:null,codigo:"",nombre:"",es_producto_compuesto:!1,peso_total_gr:"",peso_unidad_gr:"",codigo_barras:"",stock_minimo:null},r.value=[]},$=()=>{r.value.push({producto_base:null,cantidad:1,peso_unitario:0,peso_total:0,codigoDigitado:"",nombreDigitado:""})},K=async o=>{const a=r.value[o];if(a.id)try{await lo.A.delete(`/inventory/materiales-producto/${a.id}`),alert("Material eliminado correctamente.")}catch(e){console.error("Error al eliminar material:",e),alert("No se pudo eliminar el material.")}r.value.splice(o,1)},B=o=>{const a=r.value[o],e=t.value.find((o=>o.id===a.producto_base));e?(a.peso_unitario=e.peso_unidad_gr,a.peso_total=a.cantidad*a.peso_unitario):(a.peso_unitario=0,a.peso_total=0)},q=async o=>{if(confirm("¬øEst√°s seguro de que deseas eliminar este producto?"))try{await lo.A.delete(`/inventory/productos/${o}`),alert("Producto eliminado correctamente"),e.value=e.value.filter((a=>a.id!==o)),c.value-=1}catch(a){console.error("Error al eliminar producto:",a),alert("No se pudo eliminar el producto.")}},X=async()=>{try{const o=await lo.A.get("/inventory/productos",{params:{offset:0,limit:1e4,search_codigo:s.value,search_nombre:l.value}}),a=o.data.productos,e=[["Productos Cargados"],["C√≥digo","Nombre","Peso Total (g)","Peso Unidad (g)","C√≥digo de Barras","Prod. Compuesto","Stock M√≠nimo"],...a.map((o=>[o.codigo,o.nombre,o.peso_total_gr||"",o.peso_unidad_gr||"",o.codigo_barras||"",o.es_producto_compuesto?"S√≠":"No",null!==o.stock_minimo?o.stock_minimo:""]))],r=co.Wp.aoa_to_sheet(e),t=co.Wp.book_new();co.Wp.book_append_sheet(t,r,"Productos"),co._h(t,`Productos_Cargados_${(new Date).toISOString().slice(0,10)}.xlsx`)}catch(o){console.error("Error al exportar a Excel:",o),alert("Ocurri√≥ un error al exportar los productos a Excel.")}},j=()=>{navigator.clipboard.writeText(m.value).then((()=>alert("Errores copiados al portapapeles.")))},T=()=>{navigator.clipboard.writeText(v.value).then((()=>alert("Errores copiados al portapapeles.")))},G=()=>{I(),e.value=[],s.value="",l.value="",c.value=0,n.value=0,F(),O()},J=()=>{s.value="",l.value="",e.value=[],c.value=0,n.value=0},F=()=>{u.value=null,m.value="",_.value&&(_.value.value="")},O=()=>{p.value=null,v.value="",L.value&&(L.value.value="")},Q=()=>{I(),i.value=!1},W=()=>{const o='# Instructivo: Llene los campos seg√∫n corresponda.\n# Si "es_producto_compuesto" es "S√≠", debe completar las columnas de "cantidad_productos", "codigo1", "cantidad1", "codigo2", etc.\n# Si el producto es Base, se coloca cero 0. Si el producto es compuesto, indicar cu√°ntos productos base lo conforman.\n# "stock_minimo" es opcional; d√©jelo en blanco si no aplica.\ncodigo,nombre,peso_total_gr,peso_unidad_gr,codigo_barras,es_producto_compuesto,stock_minimo,cantidad_productos,codigo1,cantidad1,codigo2,cantidad2\nGRA12345678901234,Ejemplo Producto Base,500,50,1234567890123,No,100,0,,,,\nGRA98765432109876,Ejemplo Producto Compuesto,,,9876543210987,S√≠,10,2,GRA12345678901234,2,GRA12199905000000,3\n',a=new Blob([o],{type:"text/csv;charset=utf-8;"}),e=document.createElement("a");e.href=URL.createObjectURL(a),e.setAttribute("download","Plantilla_Carga_Productos.csv"),document.body.appendChild(e),e.click(),document.body.removeChild(e)},H=()=>{const o="# Instructivo: Llene los campos para actualizar productos existentes.\n# 'codigo' es obligatorio y debe coincidir con un producto existente.\n# Los dem√°s campos son opcionales; d√©jelos en blanco para no modificarlos.\n# Si 'es_producto_compuesto' es \"S√≠\", complete 'cantidad_productos', 'codigo1', 'cantidad1', etc.\n# Los productos base deben existir.\n# Nota: El c√≥digo y el nombre deben ser √∫nicos.\ncodigo,nombre,peso_total_gr,peso_unidad_gr,codigo_barras,es_producto_compuesto,stock_minimo,cantidad_productos,codigo1,cantidad1,codigo2,cantidad2\nGRA12345678901234,Producto Base Actualizado,600,60,1234567890123,No,150,,,,\nGRA98765432109876,Kit Compuesto Actualizado,,,9876543210987,S√≠,20,2,GRA12345678901234,3,GRA12199905000000,4\n",a=new Blob([o],{type:"text/csv;charset=utf-8;"}),e=document.createElement("a");e.href=URL.createObjectURL(a),e.setAttribute("download","Plantilla_Actualizacion_Productos.csv"),document.body.appendChild(e),e.click(),document.body.removeChild(e)},Y=()=>{g.value=!0},Z=()=>{g.value=!1},oo=()=>{b.value=!0},ao=()=>{b.value=!1};return y(),{producto:a,productos:e,materiales:r,productosDisponibles:t,modoEdicion:i,filtroCodigo:s,filtroNombre:l,totalProductos:c,offset:n,limit:d,archivoCsv:u,archivoActualizarCsv:p,erroresCsv:m,erroresActualizarCsv:v,mostrarModal:g,mostrarModalActualizar:b,isLoadingCarga:k,isLoadingActualizar:C,inputCsv:_,inputActualizarCsv:L,crearProducto:h,consultarProductos:P,cargarMaterialesProducto:f,cargarProductosDisponibles:y,guardarMateriales:E,cargarMasProductos:A,cargarCsv:z,procesarCsv:S,cargarArchivoActualizarCsv:M,procesarActualizacionCsv:V,sincronizarSelector:N,sincronizarCodigo:R,sincronizarPorNombre:D,editarProducto:U,actualizarProducto:w,cancelarEdicion:x,resetearFormulario:I,agregarMaterial:$,eliminarMaterial:K,actualizarPesoMaterial:B,eliminarProducto:q,exportarAExcel:X,copiarErrores:j,copiarErroresActualizar:T,limpiarPagina:G,limpiarCampos:J,limpiarSesionCsv:F,limpiarActualizarCsv:O,limpiarSesion:Q,descargarPlantillaCSV:W,descargarPlantillaActualizarCSV:H,mostrarInstructivo:Y,cerrarModal:Z,mostrarInstructivoActualizar:oo,cerrarModalActualizar:ao}},watch:{"producto.id":function(o){o&&this.cargarMaterialesProducto()}}},uo=e(1241);const po=(0,uo.A)(no,[["render",ro],["__scopeId","data-v-911abece"]]);var mo=po}}]);
//# sourceMappingURL=625.e61ed68a.js.map