"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[85],{5085:function(e,t,a){a.r(t),a.d(t,{default:function(){return S}});var o=a(6768),n=a(4232),l=a(5130);const r={class:"reportes-produccion"},i={class:"main-title"},s={key:0,class:"cliente-nombre"},d={class:"actions",style:{"justify-content":"flex-end"}},c={class:"section filter-section"},u={class:"filter-container"},h={class:"filter-group"},p={class:"filter-group"},f={class:"filter-group"},k={class:"filter-group"},L={class:"filter-actions"},b=["disabled"],m={key:1,class:"section table-section"},_={class:"table-container"},F={class:"custom-table"},g=["onClick"],v=["onClick"],P=["onClick"],E={key:2,class:"error-message"},C={key:3,class:"section detail-section"},O={class:"detail-container"},y={class:"detail-actions"},N={class:"info-general-card"},w={class:"custom-table"},A={class:"custom-table"},D={class:"custom-table"},I={class:"custom-table"},x={key:0,class:"custom-table"},R={key:1,class:"text-muted"},z={key:2,class:"detail-section"},X={key:3,class:"detail-section"};function W(e,t,a,W,$,q){const U=(0,o.g2)("font-awesome-icon");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("h1",i,[(0,o.bF)(U,{icon:"chart-bar"}),t[9]||(t[9]=(0,o.eW)(" Reportes de Producción"))]),W.store.state.cliente.nombre?((0,o.uX)(),(0,o.CE)("h2",s,(0,n.v_)(W.store.state.cliente.nombre),1)):(0,o.Q3)("",!0),(0,o.Lk)("div",d,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>q.limpiarPagina&&q.limpiarPagina(...e)),class:"btn btn-warning"},"Limpiar Página")]),(0,o.Lk)("section",c,[t[17]||(t[17]=(0,o.Lk)("h2",{class:"section-title"},"Consultar Órdenes",-1)),(0,o.Lk)("div",u,[(0,o.Lk)("div",h,[t[10]||(t[10]=(0,o.Lk)("label",{for:"numero-orden",class:"filter-label"},"Número de Orden:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"numero-orden",class:"filter-input","onUpdate:modelValue":t[1]||(t[1]=e=>$.filtroNumeroOrden=e),placeholder:"Ej: ORDEN-123"},null,512),[[l.Jo,$.filtroNumeroOrden]])]),(0,o.Lk)("div",p,[t[12]||(t[12]=(0,o.Lk)("label",{for:"estado",class:"filter-label"},"Estado:",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>$.filtroEstado=e),id:"estado",class:"filter-select"},t[11]||(t[11]=[(0,o.Fv)('<option value="" data-v-5288b1dc>Todos</option><option value="Pendiente" data-v-5288b1dc>Pendiente</option><option value="Lista para Producción" data-v-5288b1dc>Lista para Producción</option><option value="En Producción" data-v-5288b1dc>En Producción</option><option value="En Producción-Parcial" data-v-5288b1dc>En Producción-Parcial</option><option value="Finalizada" data-v-5288b1dc>Finalizada</option>',6)]),512),[[l.u1,$.filtroEstado]])]),(0,o.Lk)("div",f,[t[13]||(t[13]=(0,o.Lk)("label",{for:"fecha-inicio",class:"filter-label"},"Fecha Inicio:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"date",id:"fecha-inicio",class:"filter-input","onUpdate:modelValue":t[3]||(t[3]=e=>$.filtroFechaInicio=e)},null,512),[[l.Jo,$.filtroFechaInicio]])]),(0,o.Lk)("div",k,[t[14]||(t[14]=(0,o.Lk)("label",{for:"fecha-fin",class:"filter-label"},"Fecha Fin:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"date",id:"fecha-fin",class:"filter-input","onUpdate:modelValue":t[4]||(t[4]=e=>$.filtroFechaFin=e)},null,512),[[l.Jo,$.filtroFechaFin]])])]),t[18]||(t[18]=(0,o.Lk)("p",{class:"filter-note"}," Nota: Para incluir órdenes del día actual, seleccione un día adicional para Fecha Fin. ",-1)),(0,o.Lk)("div",L,[(0,o.Lk)("button",{class:"action-button search-button",onClick:t[5]||(t[5]=(...e)=>q.consultarOrdenes&&q.consultarOrdenes(...e))},[(0,o.bF)(U,{icon:"search"}),t[15]||(t[15]=(0,o.eW)(" Consultar "))]),(0,o.Lk)("button",{class:"action-button pdf-button",onClick:t[6]||(t[6]=(...e)=>q.imprimirListadoPdf&&q.imprimirListadoPdf(...e)),disabled:0===$.ordenes.length},[(0,o.bF)(U,{icon:"file-pdf"}),t[16]||(t[16]=(0,o.eW)(" Imprimir Listado "))],8,b)])]),$.ordenes.length>0?((0,o.uX)(),(0,o.CE)("section",m,[t[23]||(t[23]=(0,o.Lk)("h2",{class:"section-title"},"Órdenes de Producción",-1)),(0,o.Lk)("div",_,[(0,o.Lk)("table",F,[t[22]||(t[22]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Número de Orden"),(0,o.Lk)("th",null,"Producto"),(0,o.Lk)("th",null,"Cantidad a Producir"),(0,o.Lk)("th",null,"Estado"),(0,o.Lk)("th",null,"Fecha Estado"),(0,o.Lk)("th",null,"Tiempo en Producción"),(0,o.Lk)("th",null,"Acciones")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)($.ordenes,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,(0,n.v_)(e.numero_orden),1),(0,o.Lk)("td",null,(0,n.v_)(e.producto_compuesto_nombre),1),(0,o.Lk)("td",null,(0,n.v_)(e.cantidad_paquetes.toFixed(2)),1),(0,o.Lk)("td",null,(0,n.v_)(e.estado),1),(0,o.Lk)("td",null,(0,n.v_)(q.obtenerFechaEstado(e)),1),(0,o.Lk)("td",null,(0,n.v_)(q.calcularTiempoProduccion(e)),1),(0,o.Lk)("td",null,[(0,o.Lk)("button",{class:"table-button detail-button",onClick:t=>q.cargarDetalleOrden(e.id)},[(0,o.bF)(U,{icon:"eye"}),t[19]||(t[19]=(0,o.eW)(" Detalle "))],8,g),(0,o.Lk)("button",{class:"table-button pdf-button",onClick:t=>q.descargarPdf(e.id)},[(0,o.bF)(U,{icon:"file-pdf"}),t[20]||(t[20]=(0,o.eW)(" Imprimir "))],8,v),(0,o.Lk)("button",{class:"table-button pdf-no-cost-button",onClick:t=>q.descargarPdfOperador(e.id)},[(0,o.bF)(U,{icon:"file-pdf"}),t[21]||(t[21]=(0,o.eW)(" Sin Costos "))],8,P)])])))),128))])])])])):(0,o.Q3)("",!0),$.consultaRealizada&&0===$.ordenes.length&&($.filtroEstado||$.filtroNumeroOrden||$.filtroFechaInicio)?((0,o.uX)(),(0,o.CE)("p",E," No se encontraron órdenes de producción con los filtros seleccionados. ")):(0,o.Q3)("",!0),$.mostrarDetalle?((0,o.uX)(),(0,o.CE)("section",C,[t[42]||(t[42]=(0,o.Lk)("h2",{class:"section-title"},"Detalle de la Orden",-1)),(0,o.Lk)("div",O,[(0,o.Lk)("div",y,[(0,o.Lk)("button",{class:"action-button pdf-button",onClick:t[7]||(t[7]=e=>q.descargarPdf($.detalleOrden.id))},[(0,o.bF)(U,{icon:"file-pdf"}),t[24]||(t[24]=(0,o.eW)(" Imprimir "))]),(0,o.Lk)("button",{class:"action-button pdf-no-cost-button",onClick:t[8]||(t[8]=e=>q.descargarPdfOperador($.detalleOrden.id))},[(0,o.bF)(U,{icon:"file-pdf"}),t[25]||(t[25]=(0,o.eW)(" Imprimir Sin Costos "))])]),(0,o.Lk)("div",N,[(0,o.Lk)("p",null,[t[26]||(t[26]=(0,o.Lk)("strong",null,"Número de Orden:",-1)),(0,o.eW)(" "+(0,n.v_)($.detalleOrden?.numero_orden||"N/A"),1)]),(0,o.Lk)("p",null,[t[27]||(t[27]=(0,o.Lk)("strong",null,"Producto:",-1)),(0,o.eW)(" "+(0,n.v_)($.detalleOrden?.producto_compuesto_nombre||"N/A"),1)]),(0,o.Lk)("p",null,[t[28]||(t[28]=(0,o.Lk)("strong",null,"Cantidad de Paquetes:",-1)),(0,o.eW)(" "+(0,n.v_)($.detalleOrden?.cantidad_paquetes?.toFixed(2)||"N/A"),1)]),(0,o.Lk)("p",null,[t[29]||(t[29]=(0,o.Lk)("strong",null,"Bodega de Producción:",-1)),(0,o.eW)(" "+(0,n.v_)($.detalleOrden?.bodega_produccion_nombre||"No especificada"),1)]),(0,o.Lk)("p",null,[t[30]||(t[30]=(0,o.Lk)("strong",null,"Estado:",-1)),(0,o.eW)(" "+(0,n.v_)($.detalleOrden?.estado||"N/A"),1)])]),(0,o.Lk)("table",w,[(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[t[31]||(t[31]=(0,o.Lk)("td",{class:"table-label"},"Costo Unitario",-1)),(0,o.Lk)("td",null,(0,n.v_)($.detalleOrden?.costo_unitario?.toFixed(2)||"N/A"),1),t[32]||(t[32]=(0,o.Lk)("td",{class:"table-label"},"Costo Total",-1)),(0,o.Lk)("td",null,(0,n.v_)($.detalleOrden?.costo_total?.toFixed(2)||"N/A"),1)])])]),(0,o.Lk)("table",A,[t[33]||(t[33]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",{colspan:"4"},"-- Fechas de Producción --")]),(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Creación"),(0,o.Lk)("th",null,"Lista para Producción"),(0,o.Lk)("th",null,"Inicio Producción"),(0,o.Lk)("th",null,"Finalización")])],-1)),(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("td",null,(0,n.v_)(q.formatFecha($.detalleOrden?.fecha_creacion)),1),(0,o.Lk)("td",null,(0,n.v_)(q.formatFecha($.detalleOrden?.fecha_lista_para_produccion)),1),(0,o.Lk)("td",null,(0,n.v_)(q.formatFecha($.detalleOrden?.fecha_inicio)),1),(0,o.Lk)("td",null,(0,n.v_)(q.formatFecha($.detalleOrden?.fecha_finalizacion)),1)])])]),(0,o.Lk)("table",D,[(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[t[34]||(t[34]=(0,o.Lk)("td",{class:"table-label"},"Creado por",-1)),(0,o.Lk)("td",null,(0,n.v_)($.detalleOrden?.creado_por||"N/A"),1),t[35]||(t[35]=(0,o.Lk)("td",{class:"table-label"},"Producido por",-1)),(0,o.Lk)("td",null,(0,n.v_)($.detalleOrden?.producido_por||"N/A"),1)])])]),t[40]||(t[40]=(0,o.Lk)("h3",{class:"section-subtitle"},"Componentes",-1)),(0,o.Lk)("table",I,[t[36]||(t[36]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Componente"),(0,o.Lk)("th",null,"Cant. x Paquete"),(0,o.Lk)("th",null,"Cant. Total"),(0,o.Lk)("th",null,"Peso x Paquete"),(0,o.Lk)("th",null,"Peso Total")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)($.componentes,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.nombre},[(0,o.Lk)("td",null,(0,n.v_)(e.nombre),1),(0,o.Lk)("td",null,(0,n.v_)(e.cant_x_paquete.toFixed(2)),1),(0,o.Lk)("td",null,(0,n.v_)(e.cantidad_total.toFixed(2)),1),(0,o.Lk)("td",null,(0,n.v_)(e.peso_x_paquete.toFixed(2)),1),(0,o.Lk)("td",null,(0,n.v_)(e.peso_total.toFixed(2)),1)])))),128))])]),t[41]||(t[41]=(0,o.Lk)("h3",{class:"section-subtitle"},"Historial de Entregas",-1)),$.historialEntregas.length>0?((0,o.uX)(),(0,o.CE)("table",x,[t[37]||(t[37]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Cantidad Entregada"),(0,o.Lk)("th",null,"Fecha y Hora"),(0,o.Lk)("th",null,"Comentario")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)($.historialEntregas,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,(0,n.v_)(e.cantidad.toFixed(2)),1),(0,o.Lk)("td",null,(0,n.v_)(q.formatFecha(e.fecha_hora)),1),(0,o.Lk)("td",null,(0,n.v_)(e.comentario||"N/A"),1)])))),128))])])):((0,o.uX)(),(0,o.CE)("p",R,"No hay entregas registradas para esta orden.")),$.detalleOrden?.comentario_cierre_forzado?((0,o.uX)(),(0,o.CE)("div",z,[t[38]||(t[38]=(0,o.Lk)("h3",{class:"section-subtitle"},"Cierre Forzado",-1)),(0,o.Lk)("p",null,(0,n.v_)($.detalleOrden.comentario_cierre_forzado),1)])):"Finalizada"===$.detalleOrden?.estado?((0,o.uX)(),(0,o.CE)("div",X,t[39]||(t[39]=[(0,o.Lk)("h3",{class:"section-subtitle"},"Orden Finalizada sin Novedad",-1)]))):(0,o.Q3)("",!0)])])):(0,o.Q3)("",!0)])}a(4114),a(8111),a(1701),a(4603),a(7566),a(8721);var $=a(782),q=a(292),U=a(7682),T=a(4084),j={name:"ReportesProduccion",components:{FontAwesomeIcon:q.gc},setup(){const e=(0,$.Pj)();return{store:e,toast:T.oR}},data(){return{filtroNumeroOrden:"",filtroEstado:"",filtroFechaInicio:"",filtroFechaFin:"",ordenes:[],detalleOrden:null,componentes:[],historialEntregas:[],mostrarDetalle:!1,consultaRealizada:!1}},methods:{formatFecha(e){if(!e)return"N/A";const t=new Date(e);return t.toLocaleString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},limpiarPagina(){this.filtroNumeroOrden="",this.filtroEstado="",this.filtroFechaInicio="",this.filtroFechaFin="",this.ordenes=[],this.detalleOrden=null,this.componentes=[],this.historialEntregas=[],this.mostrarDetalle=!1,this.consultaRealizada=!1,this.toast.success("Página limpiada correctamente.")},calcularTiempoProduccion(e){if(!e.fecha_creacion)return"N/A";let t=e.fecha_finalizacion||e.fecha_inicio||e.fecha_lista_para_produccion||e.fecha_creacion;if(!t)return"N/A";let a=new Date(e.fecha_creacion),o=new Date(t),n=o-a,l=n/36e5;if(l>=24){let e=Math.floor(l/24);return`${e} día(s)`}return`${Math.floor(l)} hora(s)`},obtenerFechaEstado(e){switch(e.estado){case"Pendiente":return this.formatFecha(e.fecha_creacion);case"Lista para Producción":return this.formatFecha(e.fecha_lista_para_produccion);case"En Producción":case"En Producción-Parcial":return this.formatFecha(e.fecha_inicio);case"Finalizada":return this.formatFecha(e.fecha_finalizacion);default:return"N/A"}},async consultarOrdenes(){if(this.filtroNumeroOrden||this.filtroEstado||this.filtroFechaInicio||this.filtroFechaFin)try{const e={};this.filtroNumeroOrden&&(e.numero_orden=this.filtroNumeroOrden),e.estado=this.filtroEstado||null,this.filtroFechaInicio&&this.filtroFechaFin&&(e.fecha_inicio=this.filtroFechaInicio,e.fecha_fin=this.filtroFechaFin);const t=await U.A.get("/api/ordenes-produccion/filtrar",{params:e});this.ordenes=t.data.sort(((e,t)=>t.id-e.id)),this.consultaRealizada=!0,this.mostrarDetalle=!1,this.detalleOrden=null,this.componentes=[],this.historialEntregas=[],this.toast.success("Órdenes consultadas correctamente.")}catch(e){console.error("Error al consultar órdenes:",e.response?.status,e.response?.data,e.message),this.consultaRealizada=!0,this.toast.error("No se pudieron consultar las órdenes de producción.")}else this.toast.warning("Por favor, ingrese al menos un filtro para consultar.")},async imprimirListadoPdf(){try{const e={estado:this.filtroEstado||null,fecha_inicio:this.filtroFechaInicio||null,fecha_fin:this.filtroFechaFin||null},t=await U.A.post("/api/ordenes-produccion/listado-pdf",e,{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([t.data])),o=document.createElement("a");o.href=a,o.setAttribute("download","Listado_Ordenes_Produccion.pdf"),document.body.appendChild(o),o.click(),document.body.removeChild(o),this.toast.success("PDF generado correctamente.")}catch(e){console.error("Error al generar PDF:",e),this.toast.error("No se pudo generar el PDF del listado.")}},async cargarDetalleOrden(e){try{console.log(`Cargando detalle para orden ID: ${e}`);const t=await U.A.get(`/api/ordenes-produccion/${e}`);console.log("Respuesta de detalle:",t.data),this.detalleOrden={...t.data,bodega_produccion_nombre:t.data.bodega_produccion_nombre||"No especificada",creado_por:t.data.creado_por||"N/A",producido_por:t.data.producido_por||"N/A"},this.componentes=t.data.materiales?.map((e=>({nombre:e.producto_base_nombre,cant_x_paquete:e.cant_x_paquete,cantidad_total:e.cantidad_total,peso_x_paquete:e.peso_x_paquete,peso_total:e.peso_total})))||[];const a=await U.A.get(`/api/ordenes-produccion/${e}/historial-entregas`);console.log("Respuesta de historial:",a.data),this.historialEntregas=a.data.historial||[],this.mostrarDetalle=!0,this.toast.success("Detalle de la orden cargado correctamente.")}catch(t){console.error("Error al cargar detalle:",t.response?.status,t.response?.data,t.message),this.toast.error(`No se pudo cargar el detalle de la orden: ${t.message}`),this.mostrarDetalle=!1}},async descargarPdf(e){if(e)try{const t=await U.A.get(`/api/ordenes-produccion/${e}/pdf`,{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([t.data])),o=document.createElement("a");o.href=a,o.setAttribute("download",`Orden_${e}.pdf`),document.body.appendChild(o),o.click(),document.body.removeChild(o),this.toast.success("PDF descargado correctamente.")}catch(t){console.error("Error al descargar PDF:",t),this.toast.error("No se pudo descargar el PDF de la orden.")}else this.toast.error("El ID de la orden no está disponible.")},async descargarPdfOperador(e){if(e)try{const t=await U.A.get(`/api/ordenes-produccion/${e}/pdf-operador`,{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([t.data])),o=document.createElement("a");o.href=a,o.setAttribute("download",`Orden_${e}_Operador.pdf`),document.body.appendChild(o),o.click(),document.body.removeChild(o),this.toast.success("PDF sin costos descargado correctamente.")}catch(t){console.error("Error al descargar PDF operador:",t),this.toast.error("No se pudo descargar el PDF sin costos.")}else this.toast.error("El ID de la orden no está disponible.")},volverAlMenu(){const e=localStorage.getItem("tipo_usuario");"admin"===e||"gerente"===e||"operador"===e?this.$router.push("/production"):(this.toast.error("Rol no reconocido. Contacta al administrador."),this.$router.push("/login"))}}},Q=a(1241);const B=(0,Q.A)(j,[["render",W],["__scopeId","data-v-5288b1dc"]]);var S=B}}]);
//# sourceMappingURL=85.83742b77.js.map