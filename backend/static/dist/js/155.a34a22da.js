"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[155],{6155:function(a,e,l){l.r(e),l.d(e,{default:function(){return N}});var t=l(6768),r=l(4232),o=l(5130);const n={class:"cargar-ventas"},c={class:"menu-buttons"},u={class:"form-section"},s={class:"form-group"},i={key:0,class:"form-section"},d={class:"form-section"},v={class:"consulta-ventas form-section"},f={class:"form-group"},k={class:"form-group"},p={class:"form-group"},L={class:"form-group"},g=["value"],h={class:"form-group"},b=["value"],C={key:1,class:"resultados-ventas form-section"},m={class:"form-actions"},F={class:"table-container"},_=["onClick"],y={key:2,class:"detalle-venta form-section"},E={class:"form-actions"},x={class:"table-container"};function V(a,e,l,V,K,R){const A=(0,t.g2)("font-awesome-icon");return(0,t.uX)(),(0,t.CE)("div",n,[e[29]||(e[29]=(0,t.Lk)("h1",null,"Cargar Ventas Manualmente",-1)),(0,t.Lk)("section",c,[(0,t.Lk)("button",{onClick:e[0]||(e[0]=(...a)=>V.limpiarPagina&&V.limpiarPagina(...a)),class:"btn btn-warning"},"Limpiar Página")]),(0,t.Lk)("section",u,[e[13]||(e[13]=(0,t.Lk)("h2",null,"Subir Archivo CSV",-1)),(0,t.Lk)("div",s,[e[12]||(e[12]=(0,t.Lk)("label",{for:"inputCsv"},"Archivo CSV:",-1)),(0,t.Lk)("input",{id:"inputCsv",type:"file",onChange:e[1]||(e[1]=(...a)=>V.cargarCsv&&V.cargarCsv(...a)),ref:"inputCsv"},null,544)]),(0,t.Lk)("button",{onClick:e[2]||(e[2]=(...a)=>V.procesarCsv&&V.procesarCsv(...a))},"Cargar Ventas")]),V.errores.length?((0,t.uX)(),(0,t.CE)("section",i,[e[14]||(e[14]=(0,t.Lk)("h2",null,"Errores Detectados:",-1)),(0,t.Lk)("ul",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(V.errores,((a,e)=>((0,t.uX)(),(0,t.CE)("li",{key:e},(0,r.v_)(a),1)))),128))])])):(0,t.Q3)("",!0),(0,t.Lk)("section",d,[e[15]||(e[15]=(0,t.Lk)("h2",null,"Descargar Plantilla",-1)),(0,t.Lk)("button",{onClick:e[3]||(e[3]=(...a)=>V.descargarPlantilla&&V.descargarPlantilla(...a))},"Descargar")]),(0,t.Lk)("section",v,[e[23]||(e[23]=(0,t.Lk)("h2",null,"Consulta de Facturas de Venta",-1)),(0,t.Lk)("div",f,[e[16]||(e[16]=(0,t.Lk)("label",{for:"filtroFactura"},"Número de Factura:",-1)),(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>V.filtroFactura=a),id:"filtroFactura",placeholder:"Ingrese número de factura"},null,512),[[o.Jo,V.filtroFactura]])]),(0,t.Lk)("div",k,[e[17]||(e[17]=(0,t.Lk)("label",{for:"fechaInicio"},"Fecha Inicio:",-1)),(0,t.bo)((0,t.Lk)("input",{type:"date","onUpdate:modelValue":e[5]||(e[5]=a=>V.fechaInicio=a),id:"fechaInicio"},null,512),[[o.Jo,V.fechaInicio]])]),(0,t.Lk)("div",p,[e[18]||(e[18]=(0,t.Lk)("label",{for:"fechaFin"},"Fecha Fin:",-1)),(0,t.bo)((0,t.Lk)("input",{type:"date","onUpdate:modelValue":e[6]||(e[6]=a=>V.fechaFin=a),id:"fechaFin"},null,512),[[o.Jo,V.fechaFin]])]),(0,t.Lk)("div",L,[e[20]||(e[20]=(0,t.Lk)("label",{for:"filtroBodega"},"Bodega de Venta:",-1)),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>V.filtroBodega=a),id:"filtroBodega"},[e[19]||(e[19]=(0,t.Lk)("option",{value:"",disabled:""},"Seleccione una bodega",-1)),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(V.bodegas,(a=>((0,t.uX)(),(0,t.CE)("option",{key:a.id,value:a.id},(0,r.v_)(a.nombre),9,g)))),128))],512),[[o.u1,V.filtroBodega]])]),(0,t.Lk)("div",h,[e[22]||(e[22]=(0,t.Lk)("label",{for:"selectorFactura"},"Seleccionar Factura:",-1)),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":e[8]||(e[8]=a=>V.filtroFactura=a),id:"selectorFactura"},[e[21]||(e[21]=(0,t.Lk)("option",{value:"",disabled:""},"Seleccione una factura",-1)),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(V.facturas,(a=>((0,t.uX)(),(0,t.CE)("option",{key:a,value:a},(0,r.v_)(a),9,b)))),128))],512),[[o.u1,V.filtroFactura]])]),(0,t.Lk)("button",{onClick:e[9]||(e[9]=(...a)=>V.consultarVentas&&V.consultarVentas(...a))},"Consultar Facturas")]),V.resultadosVentas.length?((0,t.uX)(),(0,t.CE)("section",C,[e[26]||(e[26]=(0,t.Lk)("h3",null,"Resultados de la Consulta",-1)),(0,t.Lk)("div",m,[(0,t.Lk)("button",{onClick:e[10]||(e[10]=(...a)=>V.exportarListadoExcel&&V.exportarListadoExcel(...a))},[e[24]||(e[24]=(0,t.eW)("Exportar Listado ")),(0,t.bF)(A,{icon:"file-excel",class:"excel-icon"})])]),(0,t.Lk)("div",F,[(0,t.Lk)("table",null,[e[25]||(e[25]=(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",null,"Número de Factura"),(0,t.Lk)("th",null,"Fecha y Hora"),(0,t.Lk)("th",null,"Acción")])],-1)),(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(V.resultadosVentas,(a=>((0,t.uX)(),(0,t.CE)("tr",{key:a.factura},[(0,t.Lk)("td",null,(0,r.v_)(a.factura),1),(0,t.Lk)("td",null,(0,r.v_)(a.fecha),1),(0,t.Lk)("td",null,[(0,t.Lk)("button",{onClick:e=>V.verDetalleVenta(a.factura),class:"btn btn-info"},"Detalle",8,_)])])))),128))])])])])):(0,t.Q3)("",!0),V.detalleVenta.length?((0,t.uX)(),(0,t.CE)("section",y,[(0,t.Lk)("h3",null,"Detalle de la Factura de Venta "+(0,r.v_)(V.facturaSeleccionada),1),(0,t.Lk)("div",E,[(0,t.Lk)("button",{onClick:e[11]||(e[11]=(...a)=>V.exportarDetalleExcel&&V.exportarDetalleExcel(...a))},[e[27]||(e[27]=(0,t.eW)("Exportar ")),(0,t.bF)(A,{icon:"file-excel",class:"excel-icon"})])]),(0,t.Lk)("div",x,[(0,t.Lk)("table",null,[e[28]||(e[28]=(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",null,"Código"),(0,t.Lk)("th",null,"Nombre"),(0,t.Lk)("th",null,"Cantidad"),(0,t.Lk)("th",null,"Bodega de Venta"),(0,t.Lk)("th",null,"Precio Unitario")])],-1)),(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(V.detalleVenta,(a=>((0,t.uX)(),(0,t.CE)("tr",{key:a.id},[(0,t.Lk)("td",null,(0,r.v_)(a.codigo),1),(0,t.Lk)("td",null,(0,r.v_)(a.nombre),1),(0,t.Lk)("td",null,(0,r.v_)(a.cantidad),1),(0,t.Lk)("td",null,(0,r.v_)(a.bodega),1),(0,t.Lk)("td",null,(0,r.v_)(null!==a.precio_unitario?`$${a.precio_unitario.toFixed(2)}`:"N/A"),1)])))),128))])])])])):(0,t.Q3)("",!0)])}l(4114),l(8111),l(116),l(1701),l(4603),l(7566),l(8721);var K=l(144),R=l(1387),A=l(7682),I=l(3230),B={name:"CargarVentasManual",setup(){const a=(0,R.rd)(),e=(0,K.KR)(null),l=(0,K.KR)(null),r=(0,K.KR)([]),o=(0,K.KR)(""),n=(0,K.KR)(""),c=(0,K.KR)(""),u=(0,K.KR)(""),s=(0,K.KR)([]),i=(0,K.KR)([]),d=(0,K.KR)([]),v=(0,K.KR)([]),f=(0,K.KR)(""),k=a=>{e.value=a.target.files[0]},p=async()=>{if(!e.value)return void alert("Seleccione un archivo para cargar");const a=new FormData;a.append("file",e.value);try{const e=await A.A.post("/inventory/ventas",a);alert(e.data.message),r.value=[],C(),h()}catch(l){console.error("Error al cargar ventas:",l),l.response?.data?.errors?r.value=l.response.data.errors:alert("Ocurrió un error al cargar las ventas.")}},L=()=>{const a=[["factura","codigo","nombre","cantidad","fecha_venta","bodega","precio_unitario"],["FB1234567","GRA05299901000000","R5 BULK PASTEL YELLOW","10","2025-04-05 10:00:00","Bodega1","75.00"],["CC8901234","GRA05299909000000","R5 BULK PASTEL LIGTH PINK","5","2025-04-05 11:30:00","Bodega2",""]],e=a.map((a=>a.join(","))).join("\n"),l=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");t.href=URL.createObjectURL(l),t.setAttribute("download","plantilla_cargue_ventas.csv"),document.body.appendChild(t),t.click(),document.body.removeChild(t)},g=()=>{a.push("/inventory")},h=()=>{e.value=null,l.value&&(l.value.value="")},b=()=>{h(),r.value=[],o.value="",n.value="",c.value="",u.value="",d.value=[],v.value=[],f.value=""},C=async()=>{try{const a=await A.A.get("/inventory/ventas-facturas");s.value=a.data.facturas}catch(a){console.error("Error al cargar facturas:",a),alert("Ocurrió un error al cargar las facturas.")}},m=async()=>{try{const a=await A.A.get("/inventory/bodegas");i.value=a.data}catch(a){console.error("Error al cargar bodegas:",a),alert("Ocurrió un error al cargar las bodegas.")}},F=async()=>{try{const a={factura:o.value||void 0,fecha_inicio:n.value||void 0,fecha_fin:c.value||void 0,bodega_id:u.value||void 0},e=await A.A.get("/inventory/consultar-ventas",{params:a});d.value=e.data,v.value=[]}catch(a){console.error("Error al consultar facturas de venta:",a),alert("Ocurrió un error al consultar las facturas.")}},_=async a=>{try{f.value=a;const e=await A.A.get("/inventory/detalle-venta",{params:{factura:a}});v.value=e.data}catch(e){console.error("Error al obtener detalle de la factura:",e),alert("No se pudo recuperar el detalle de la factura.")}},y=()=>{if(!d.value.length)return void alert("No hay datos para exportar a Excel.");const a=i.value.find((a=>a.id===u.value))?.nombre||"Todas",e=[["Resultado de consulta de Facturas de Ventas Cargadas"],[`Número de Factura: ${o.value||"Todos"}`],[`Fecha Inicio: ${n.value||"No especificada"}`],[`Fecha Fin: ${c.value||"No especificada"}`],[`Bodega: ${a}`],[],["Número de Factura","Fecha y Hora"],...d.value.map((a=>[a.factura,a.fecha]))],l=I.Wp.aoa_to_sheet(e),t=I.Wp.book_new();I.Wp.book_append_sheet(t,l,"Facturas"),I._h(t,`facturas_ventas_${(new Date).toISOString().slice(0,10)}.xlsx`)},E=()=>{if(!v.value.length)return void alert("No hay datos para exportar a Excel.");const a=d.value.find((a=>a.factura===f.value))?.fecha||"Desconocida",e=[[`Detalle Factura ${f.value}`],[`Fecha de Cargue: ${a}`],[],["Código","Nombre","Cantidad","Bodega de Venta","Precio Unitario"],...v.value.map((a=>[a.codigo,a.nombre,a.cantidad,a.bodega,null!==a.precio_unitario?a.precio_unitario.toFixed(2):"N/A"]))],l=I.Wp.aoa_to_sheet(e),t=I.Wp.book_new();I.Wp.book_append_sheet(t,l,"Detalle Factura"),I._h(t,`detalle_factura_${f.value}.xlsx`)};return(0,t.sV)((()=>{C(),m()})),{archivoCsv:e,inputCsv:l,errores:r,filtroFactura:o,fechaInicio:n,fechaFin:c,filtroBodega:u,facturas:s,bodegas:i,resultadosVentas:d,detalleVenta:v,facturaSeleccionada:f,cargarCsv:k,procesarCsv:p,descargarPlantilla:L,volverAlMenu:g,limpiarPagina:b,cargarFacturas:C,cargarBodegas:m,consultarVentas:F,verDetalleVenta:_,exportarListadoExcel:y,exportarDetalleExcel:E}}},w=l(1241);const D=(0,w.A)(B,[["render",V],["__scopeId","data-v-7b92625d"]]);var N=D}}]);
//# sourceMappingURL=155.a34a22da.js.map